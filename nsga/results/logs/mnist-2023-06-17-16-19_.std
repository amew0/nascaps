Namespace(batch_size=100, cache_dir='results/cache', dataset='mnist', debug=False, epochs=5, generations=50, gpus=1, lam_recon=0.392, lr=0.001, lr_decay=0.9, max_params=20000000, offsprings=10, output='out_mnist-2023-06-17-16-19', population=10, routings=3, save_dir='results/data', shift_fraction=0.1, testing=False, timeout=300, weights=None)
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]]


[[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 3, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 24], [1, 2, 4, 24, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]


[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 9, 1, 28, 32, 1], [1, 28, 32, 1, 5, 1, 28, 32, 7], [1, 28, 32, 7, 9, 1, 28, 4, 15], [1, 28, 4, 15, 9, 2, 14, 32, 30], [1, 14, 32, 30, 5, 2, 7, 64, 35], [1, 7, 64, 35, 5, 1, 7, 8, 50], [1, 7, 8, 50, 7, 1, 7, 10, 8], [-1], [1]]


lengene is 9 layer is 9
lengene is 9 layer is 9 index is 8
range(10, 8)
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]]


[[0, 28, 1, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 5, 1, 14, 64, 1], [1, 14, 64, 1, 5, 1, 14, 8, 8], [1, 14, 8, 8, 5, 1, 14, 4, 21], [1, 14, 4, 21, 14, 1, 14, 10, 64], [-1], [1]]


[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 5, 2, 7, 8, 1], [1, 7, 8, 1, 9, 1, 7, 8, 19], [1, 7, 8, 19, 5, 2, 4, 16, 36], [1, 4, 16, 36, 5, 2, 2, 4, 52], [1, 2, 4, 52, 3, 1, 2, 16, 64], [1, 2, 16, 64, 2, 2, 1, 10, 32], [-1], [1]]


lengene is 13 layer is 13
lengene is 13 layer is 13 index is 12
range(14, 12)
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 1], [0, 14, 4, 1, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]]


[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 8], [-1], [2]]


lengene is 10 layer is 10
lengene is 10 layer is 10 index is 9
range(11, 9)
[[0, 56, 1, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 5, 1, 56, 8, 1], [0, 56, 8, 1, 9, 2, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 8, 1], [2, 28, 8, 1, 3, 1, 28, 32, 4], [2, 28, 32, 4, 3, 2, 14, 32, 8], [2, 14, 32, 8, 3, 2, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 7, 1, 1, 10, 16], [-1], [2]]


lengene is 14 layer is 14
lengene is 14 layer is 14 index is 13
range(15, 13)
[[0, 56, 1, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 3, 1, 56, 4, 1], [0, 56, 4, 1, 9, 1, 56, 64, 1], [0, 56, 64, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 5, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [2, 56, 64, 1, 3, 2, 28, 32, 4], [2, 28, 32, 4, 3, 2, 14, 32, 8], [2, 14, 32, 8, 3, 2, 7, 32, 8], [2, 7, 32, 8, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [2]]



 Evaluate population.

### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 64]
Added Conv4_layer
[None, 7, 7, 192]
rem 2
Added Caps1_layer
[None, 4, 4, 208]
rem 1
Added Caps2_layer
[None, 4, 4, 208]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    404         batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 64)   256         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 192)    307392      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 192)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 208)    3235024     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 208)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 416, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2129920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 6,229,929
Trainable params: 6,229,737
Non-trainable params: 192
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 062325fe0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7998841583850722

Train accuracy: 0.7998841583850722



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 5719816
OPT eval latency = 0.0011241780000000004
OPT eval accuracy_drop = 0.2001158416149278
OPT eval energy = 36.27826681387202
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 3, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 24], [1, 2, 4, 24, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 16]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 16]
Added Conv4_layer
[None, 14, 14, 64]
Added Conv5_layer
[None, 7, 7, 416]
rem 4
Added Caps1_layer
[None, 4, 4, 1088]
rem 3
Added Caps2_layer
[None, 2, 2, 96]
rem 2
Added Caps3_layer
[None, 2, 2, 168]
rem 1
Added Caps4_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 16)   1312        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   41504       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 16)   2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 14, 14, 64)   9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 14, 14, 64)   256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 7, 7, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 4, 4, 1088)   4074560     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 96)     940128      lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 96)     0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 2, 2, 168)    145320      lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 2, 2, 168)    0           conv2d_9[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_4[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 5,985,433
Trainable params: 5,985,113
Non-trainable params: 320
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 06bc0d0a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9407933642977928

Train accuracy: 0.9407933642977928



HW Estimator

10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 5941072
OPT eval latency = 0.0012355860000000003
OPT eval accuracy_drop = 0.05920663570220719
OPT eval energy = 20.96720067614401
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 9, 1, 28, 32, 1], [1, 28, 32, 1, 5, 1, 28, 32, 7], [1, 28, 32, 7, 9, 1, 28, 4, 15], [1, 28, 4, 15, 9, 2, 14, 32, 30], [1, 14, 32, 30, 5, 2, 7, 64, 35], [1, 7, 64, 35, 5, 1, 7, 8, 50], [1, 7, 8, 50, 7, 1, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 28, 28, 32]
Added Conv3_layer
[None, 28, 28, 224]
rem 5
Added Caps1_layer
[None, 28, 28, 60]
rem 4
Added Caps2_layer
[None, 14, 14, 960]
rem 3
Added Caps3_layer
[None, 7, 7, 2240]
rem 2
Added Caps4_layer
[None, 7, 7, 400]
rem 1
Added Caps5_layer
[None, 7, 7, 400]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   165920      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 32)   82976       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 32)   128         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 28, 28, 224)  179424      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 224)  0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 28, 28, 60)   1088700     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 28, 28, 60)   0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 14, 14, 960)  4666560     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 14, 14, 960)  0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 7, 7, 2240)   53762240    lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 7, 7, 2240)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 7, 7, 400)    22400400    lambda_4[0][0]                   
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 7, 7, 400)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 2450, 8)      0           lambda_5[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1568000     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 84,016,061
Trainable params: 84,015,773
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 84015773 exceeded limit 20000000

Train accuracy: 0



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 84035428
OPT eval latency = 0.017093010000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1985.7236225898719
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 4]
Added Conv3_layer
[None, 7, 7, 8]
Added Conv4_layer
ConvertToCaps0
[None, 7, 7, 8, 1]
Added CapsCell_layer

[None, 4, 4, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 16]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 4)    2308        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 8)      2600        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 8)      32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 7, 7, 8, 1)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 4, 4, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 4, 4, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 16)       327840      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 7,197,709
Trainable params: 7,197,397
Non-trainable params: 312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 079f87d80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5683740231085069

Train accuracy: 0.5683740231085069



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8327532
OPT eval latency = 0.0016815689999999997
OPT eval accuracy_drop = 0.43162597689149307
OPT eval energy = 20.226161185560006
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 5, 1, 14, 64, 1], [1, 14, 64, 1, 5, 1, 14, 8, 8], [1, 14, 8, 8, 5, 1, 14, 4, 21], [1, 14, 4, 21, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 14, 14, 64]
rem 2
Added Caps1_layer
[None, 14, 14, 84]
rem 1
Added Caps2_layer
[None, 14, 14, 84]
[None, None, 4]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   165952      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   102464      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 64)   102464      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 14, 14, 84)   134484      lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 14, 14, 84)   0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 4116, 4)      0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       10536960    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 11,580,709
Trainable params: 11,580,357
Non-trainable params: 352
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 0801e7520ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7643857015379697

Train accuracy: 0.7643857015379697



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 11098176
OPT eval latency = 0.0022152660000000013
OPT eval accuracy_drop = 0.2356142984620303
OPT eval energy = 1.8353544359903997
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 5, 2, 7, 8, 1], [1, 7, 8, 1, 9, 1, 7, 8, 19], [1, 7, 8, 19, 5, 2, 4, 16, 36], [1, 4, 16, 36, 5, 2, 2, 4, 52], [1, 2, 4, 52, 3, 1, 2, 16, 64], [1, 2, 16, 64, 2, 2, 1, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 7, 7, 8]
Added Conv3_layer
[None, 7, 7, 152]
rem 4
Added Caps1_layer
[None, 4, 4, 576]
rem 3
Added Caps2_layer
[None, 2, 2, 208]
rem 2
Added Caps3_layer
[None, 2, 2, 1024]
rem 1
Added Caps4_layer
[None, 2, 2, 1024]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   4672        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 8)      12808       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 8)      32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 152)    98648       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 152)    0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 576)    2189376     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 576)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 2, 2, 208)    2995408     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 208)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1024)   1917952     lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 2, 2, 1024)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 256, 16)      0           lambda_4[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       1310720     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,814,801
Trainable params: 8,814,609
Non-trainable params: 192
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 085b46ee0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7109000461589352

Train accuracy: 0.7109000461589352



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8623792
OPT eval latency = 0.0016516260000000004
OPT eval accuracy_drop = 0.2890999538410648
OPT eval energy = 40.66487205527999
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 1], [0, 14, 4, 1, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 8]
Added Conv2_layer
[None, 14, 14, 4]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 16]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 8)    41480       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 8)    32          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 4)    804         batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     3232        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  36864       convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 16)       327840      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 14,332,557
Trainable params: 14,332,245
Non-trainable params: 312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 08fe16ee0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7713854256456515

Train accuracy: 0.7713854256456515



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 15818732
OPT eval latency = 0.0030916649999999995
OPT eval accuracy_drop = 0.2286145743543485
OPT eval energy = 34.330456520395195
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
input shape (60000, 28, 28, 1)
input shape after reshape (60000, 28, 28)
output shape before reshape (60000, 56, 56)
output shape after reshape (60000, 56, 56, 1)
input shape (10000, 28, 28, 1)
input shape after reshape (10000, 28, 28)
output shape before reshape (10000, 56, 56)
output shape after reshape (10000, 56, 56, 1)
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 72]
rem 1
Added Caps1_layer
[None, 4, 4, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 288, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        92160       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 485,420
Trainable params: 485,004
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 0d30a1320ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8205110776752176

Train accuracy: 0.8205110776752176



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 392776
OPT eval latency = 0.00020723400000000007
OPT eval accuracy_drop = 0.17948892232478242
OPT eval energy = 0.7677513006047999
### EVAL candidate 8/10
[[0, 56, 1, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 5, 1, 56, 8, 1], [0, 56, 8, 1, 9, 2, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 8, 1], [2, 28, 8, 1, 3, 1, 28, 32, 4], [2, 28, 32, 4, 3, 2, 14, 32, 8], [2, 14, 32, 8, 3, 2, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 7, 1, 1, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 8]
Added Conv1_layer
[None, 56, 56, 8]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 28, 28, 8]
Added Conv4_layer
ConvertToCaps0
[None, 28, 28, 8, 1]
Added CapsCell_layer

[None, 28, 28, 32, 4]
Added CapsCell_layer

[None, 14, 14, 32, 8]
Added CapsCell_layer

[None, 7, 7, 32, 8]
Added CapsCell_layer

[None, 7, 7, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 7, 7, 32, 8]
[None, 7, 7, 32, 8]
[None, 1568, 8]
Added FlattenCaps_layer

[None, 10, 16]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 8)    1608        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 8)    32          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    2596        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 28, 28, 8)    808         batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 28, 28, 8)    32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 28, 28, 8, 1) 0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 28, 28, 32, 4 9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 28, 28, 32, 4 0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 14, 14, 32, 8 294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 14, 14, 32, 8 0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 7, 7, 32, 8)  18688       conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_19[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 1568, 8)      0           add_5[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 1568, 8)      0           add_5[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 3136, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 16)       4014240     concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 13,201,976
Trainable params: 13,201,888
Non-trainable params: 88
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 0db5bc960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7797069094749067

Train accuracy: 0.7797069094749067



HW Estimator

10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 12583204
OPT eval latency = 0.003713253
OPT eval accuracy_drop = 0.22029309052509327
OPT eval energy = 33.88953789815519
### EVAL candidate 9/10
[[0, 56, 1, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 3, 1, 56, 4, 1], [0, 56, 4, 1, 9, 1, 56, 64, 1], [0, 56, 64, 1, 9, 1, 56, 8, 1], [0, 56, 8, 1, 5, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [2, 56, 64, 1, 3, 2, 28, 32, 4], [2, 28, 32, 4, 3, 2, 14, 32, 8], [2, 14, 32, 8, 3, 2, 7, 32, 8], [2, 7, 32, 8, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 8]
Added Conv1_layer
[None, 56, 56, 4]
Added Conv2_layer
[None, 56, 56, 64]
Added Conv3_layer
[None, 56, 56, 8]
Added Conv4_layer
[None, 56, 56, 32]
Added Conv5_layer
[None, 56, 56, 64]
Added Conv6_layer
ConvertToCaps0
[None, 56, 56, 64, 1]
Added CapsCell_layer

[None, 28, 28, 32, 4]
Added CapsCell_layer

[None, 14, 14, 32, 8]
Added CapsCell_layer

[None, 7, 7, 32, 8]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 16]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_7 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 64)   20800       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 56, 56, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 56, 56, 8)    41480       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 56, 56, 8)    32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 56, 56, 32)   6432        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 56, 56, 32)   128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_5[0][0]      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 56, 56, 64)   256         conv2d_6[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 56, 56, 64, 1 0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 28, 28, 32, 4 73728       convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 28, 28, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 28, 28, 32, 4 0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 14, 14, 32, 8 294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 14, 14, 32, 8 589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 14, 14, 32, 8 0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 16)       327840      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 14,414,544
Trainable params: 14,414,152
Non-trainable params: 392
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 0e54c9b20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6832298903640472

Train accuracy: 0.6832298903640472



HW Estimator

14
13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 16342492
OPT eval latency = 0.006886917000000001
OPT eval accuracy_drop = 0.31677010963595276
OPT eval energy = 71.31006972929764

Evaluation of current population completed


Genetic Loop.

{'gene': [[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 3, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 24], [1, 2, 4, 24, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 1], [0, 14, 4, 1, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]], 'runid': '08fe16ee0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2286145743543485, 'energy': 34.330456520395195, 'latency': 0.0030916649999999995, 'memory': 15818732}
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is12
 len_gene is15
gene[layer][1]=2
layer is12
 len_gene is15
range(12, 12)
Fixing...
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
[-1]
Fixed.
mute_type = 0
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
range(12, 12)
Fixing...
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 9, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 32], [1, 2, 4, 32, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]], 'runid': '062325fe0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2001158416149278, 'energy': 36.27826681387202, 'latency': 0.0011241780000000004, 'memory': 5719816}
1
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 5, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]], 'runid': '062325fe0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2001158416149278, 'energy': 36.27826681387202, 'latency': 0.0011241780000000004, 'memory': 5719816}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 9, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 24], [1, 2, 4, 24, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 16]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 16]
Added Conv4_layer
[None, 14, 14, 64]
Added Conv5_layer
[None, 7, 7, 416]
rem 4
Added Caps1_layer
[None, 4, 4, 1088]
rem 3
Added Caps2_layer
[None, 2, 2, 96]
rem 2
Added Caps3_layer
[None, 2, 2, 168]
rem 1
Added Caps4_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 16)   1312        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   41504       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 16)   2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 14, 14, 64)   9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 14, 14, 64)   256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 7, 7, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 4, 4, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 96)     940128      lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 96)     0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 2, 2, 168)    145320      lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 2, 2, 168)    0           conv2d_9[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_4[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 38,573,209
Trainable params: 38,572,889
Non-trainable params: 320
__________________________________________________________________________________________________
## ERR: number of trainable params 38572889 exceeded limit 20000000

Train accuracy: 0



HW Estimator

10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 38528848
OPT eval latency = 0.007345794
OPT eval accuracy_drop = 1
OPT eval energy = 876.206967486768
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 9, 2, 4, 64, 17], [1, 4, 64, 17, 3, 2, 2, 4, 32], [1, 2, 4, 32, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 16]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 16]
Added Conv4_layer
[None, 14, 14, 64]
Added Conv5_layer
[None, 7, 7, 416]
rem 4
Added Caps1_layer
[None, 4, 4, 1088]
rem 3
Added Caps2_layer
[None, 2, 2, 128]
rem 2
Added Caps3_layer
[None, 2, 2, 168]
rem 1
Added Caps4_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 16)   1312        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   41504       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 16)   2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 14, 14, 64)   9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 14, 14, 64)   256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 7, 7, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 4, 4, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 128)    1253504     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 128)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 2, 2, 168)    193704      lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 2, 2, 168)    0           conv2d_9[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_4[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 38,934,969
Trainable params: 38,934,649
Non-trainable params: 320
__________________________________________________________________________________________________
## ERR: number of trainable params 38934649 exceeded limit 20000000

Train accuracy: 0



HW Estimator

10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 38892464
OPT eval latency = 0.007414338
OPT eval accuracy_drop = 1
OPT eval energy = 878.650967888688
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 8]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 8)    41480       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 8)    32          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   12864       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  36864       convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 14,166,217
Trainable params: 14,165,785
Non-trainable params: 432
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 0fc9e99e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6064617836102132

Train accuracy: 0.6064617836102132



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 15796712
OPT eval latency = 0.0030963569999999992
OPT eval accuracy_drop = 0.3935382163897868
OPT eval energy = 34.44826523946719
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 5, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 8]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 8)    41480       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 8)    32          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   12864       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  36864       convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  819200      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 17,836,233
Trainable params: 17,835,801
Non-trainable params: 432
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 106304120ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9112565764337448

Train accuracy: 0.9112565764337448



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 19466728
OPT eval latency = 0.003784484999999998
OPT eval accuracy_drop = 0.0887434235662552
OPT eval energy = 55.76088528211679
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 16, 1], [0, 28, 16, 1, 9, 1, 28, 32, 1], [0, 28, 32, 1, 5, 2, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 5, 2, 7, 32, 13], [1, 7, 32, 13, 9, 2, 4, 64, 17], [1, 4, 64, 17, 3, 1, 4, 4, 42], [1, 4, 4, 42, 4, 1, 4, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 16]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 16]
Added Conv4_layer
[None, 14, 14, 64]
Added Conv5_layer
[None, 7, 7, 416]
rem 3
Added Caps1_layer
[None, 4, 4, 1088]
rem 2
Added Caps2_layer
[None, 4, 4, 168]
rem 1
Added Caps3_layer
[None, 4, 4, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 16)   1312        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   41504       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 16)   2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 16)   64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 14, 14, 64)   9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 14, 14, 64)   256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 7, 7, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 4, 4, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 4, 4, 168)    1645224     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 4, 4, 168)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 672, 4)       0           lambda_3[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        107520      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 39,213,625
Trainable params: 39,213,305
Non-trainable params: 320
__________________________________________________________________________________________________
## ERR: number of trainable params 39213305 exceeded limit 20000000

Train accuracy: 0



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 39168952
OPT eval latency = 0.0075038579999999995
OPT eval accuracy_drop = 1
OPT eval energy = 882.9951194592484
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 16, 1], [0, 14, 16, 1, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 16]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 416]
rem 3
Added Caps1_layer
[None, 2, 2, 1088]
rem 2
Added Caps2_layer
[None, 2, 2, 168]
rem 1
Added Caps3_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 16)   1312        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   41504       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 2, 2, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 168)    1645224     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 168)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_3[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 39,132,985
Trainable params: 39,132,665
Non-trainable params: 320
__________________________________________________________________________________________________
## ERR: number of trainable params 39132665 exceeded limit 20000000

Train accuracy: 0



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 39085912
OPT eval latency = 0.007369566000000001
OPT eval accuracy_drop = 1
OPT eval energy = 879.3049637699231
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 1024]
Added Conv4_layer
[None, 7, 7, 192]
rem 2
Added Caps1_layer
[None, 4, 4, 208]
rem 1
Added Caps2_layer
[None, 4, 4, 208]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    404         batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 1024) 332800      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 1024) 4096        conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 192)    4915392     batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 192)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 208)    3235024     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 208)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 416, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2129920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 11,153,769
Trainable params: 11,151,657
Non-trainable params: 2,112
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 11a245540ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5316978308544728

Train accuracy: 0.5316978308544728



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 10642696
OPT eval latency = 0.0021882900000000003
OPT eval accuracy_drop = 0.46830216914552725
OPT eval energy = 141.2468007939552
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 5, 1, 28, 4, 1], [0, 28, 4, 1, 5, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 1024]
Added Conv4_layer
[None, 7, 7, 192]
rem 2
Added Caps1_layer
[None, 4, 4, 208]
rem 1
Added Caps2_layer
[None, 4, 4, 208]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    404         batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 1024) 103424      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 1024) 4096        conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 192)    4915392     batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 192)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 208)    3235024     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 208)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 416, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2129920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 10,924,393
Trainable params: 10,922,281
Non-trainable params: 2,112
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 12094efc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5533161973922623

Train accuracy: 0.5533161973922623



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 10413320
OPT eval latency = 0.0021452820000000005
OPT eval accuracy_drop = 0.44668380260773766
OPT eval energy = 141.1739491126752
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [0, 28, 4, 1, 5, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 26], [1, 4, 8, 26, 4, 2, 2, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 1024]
Added Conv4_layer
[None, 7, 7, 192]
rem 2
Added Caps1_layer
[None, 4, 4, 208]
rem 1
Added Caps2_layer
[None, 4, 4, 208]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    1300        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 1024) 103424      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 1024) 4096        conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 192)    4915392     batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 192)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 208)    3235024     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 208)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 416, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2129920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 10,925,289
Trainable params: 10,923,177
Non-trainable params: 2,112
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 127092920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5647502349254505

Train accuracy: 0.5647502349254505



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 10414216
OPT eval latency = 0.0021454740000000005
OPT eval accuracy_drop = 0.4352497650745495
OPT eval energy = 141.18203877708478
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [0, 28, 4, 1, 5, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 8], [1, 4, 8, 8, 4, 2, 2, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 1024]
Added Conv4_layer
[None, 7, 7, 192]
rem 2
Added Caps1_layer
[None, 4, 4, 64]
rem 1
Added Caps2_layer
[None, 4, 4, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    1300        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 1024) 103424      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 1024) 4096        conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 192)    4915392     batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 192)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 64)     995392      lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 4, 4, 64)     0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 128, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       655360      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 7,211,097
Trainable params: 7,208,985
Non-trainable params: 2,112
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 12d815de0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6113236254985205

Train accuracy: 0.6113236254985205



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 6686920
OPT eval latency = 0.0014477939999999996
OPT eval accuracy_drop = 0.3886763745014795
OPT eval energy = 116.73865560204483

Evaluation of current population completed

gen  0
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 1, 10, 16], [-1], [1]], 'runid': '079f87d80ec811ee974b218c4823db5d', 'accuracy_drop': 0.43162597689149307, 'energy': 20.226161185560006, 'latency': 0.0016815689999999997, 'memory': 8327532}
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is8
 len_gene is11
gene[layer][1]=2
layer is8
 len_gene is11
range(8, 8)
Fixing...
layer is8
 len_gene is11
gene[layer][1]=2
layer is5
 len_gene is11
[-1]
Fixed.
mute_type = 1
Fixing...
layer is7
 len_gene is10
gene[layer][1]=4
layer is4
 len_gene is10
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 1], [0, 14, 16, 1, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 5, 2, 7, 8, 1], [1, 7, 8, 1, 9, 1, 7, 8, 19], [1, 7, 8, 19, 5, 2, 4, 16, 36], [1, 4, 16, 36, 5, 2, 2, 4, 52], [1, 2, 4, 52, 3, 1, 2, 16, 64], [1, 2, 16, 64, 2, 2, 1, 10, 32], [-1], [1]], 'runid': '085b46ee0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2890999538410648, 'energy': 40.66487205527999, 'latency': 0.0016516260000000004, 'memory': 8623792}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]], 'runid': '079f87d80ec811ee974b218c4823db5d', 'accuracy_drop': 0.43162597689149307, 'energy': 20.226161185560006, 'latency': 0.0016815689999999997, 'memory': 8327532}
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is7
 len_gene is10
gene[layer][1]=4
layer is4
 len_gene is10
[-1]
Fixing...
layer is7
 len_gene is10
gene[layer][1]=4
layer is4
 len_gene is10
[-1]
Fixed.
mute_type = 0
layer is7
 len_gene is10
gene[layer][1]=4
layer is5
 len_gene is10
range(7, 7)
Fixing...
layer is7
 len_gene is10
gene[layer][1]=7
layer is4
 len_gene is10
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [0, 28, 4, 1, 5, 2, 14, 64, 16], [1, 14, 64, 16, 5, 2, 7, 16, 12], [1, 7, 16, 12, 9, 2, 4, 8, 8], [1, 4, 8, 8, 4, 2, 2, 10, 64], [-1], [1]], 'runid': '062325fe0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2001158416149278, 'energy': 36.27826681387202, 'latency': 0.0011241780000000004, 'memory': 5719816}
1
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 4]
Added Conv3_layer
[None, 7, 7, 8]
Added Conv4_layer
ConvertToCaps0
[None, 7, 7, 8, 1]
Added CapsCell_layer

[None, 4, 4, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   331840      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 4)    2308        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 8)      2600        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 8)      32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 7, 7, 8, 1)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 4, 4, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 4, 4, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 7,265,981
Trainable params: 7,265,669
Non-trainable params: 312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 13588e3a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7066323126704416

Train accuracy: 0.7066323126704416



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8539884
OPT eval latency = 0.001721409
OPT eval accuracy_drop = 0.2933676873295584
OPT eval energy = 22.05441588851041
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 8]
Added Conv3_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 7, 7, 32, 4]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 4, 4, 32, 8]
[None, 4, 4, 32, 8]
[None, 512, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2308        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 8)    32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 7, 7, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 7, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 4, 4, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 4, 4, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        655440      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 7,425,405
Trainable params: 7,425,221
Non-trainable params: 184
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 13d3ae760ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5881940734819594

Train accuracy: 0.5881940734819594



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8476844
OPT eval latency = 0.0019071810000000008
OPT eval accuracy_drop = 0.4118059265180406
OPT eval energy = 21.55297343447521
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 416]
rem 3
Added Caps1_layer
[None, 2, 2, 1088]
rem 2
Added Caps2_layer
[None, 2, 2, 168]
rem 1
Added Caps3_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   1327136     batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 2, 2, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 168)    1645224     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 168)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_3[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 40,461,273
Trainable params: 40,459,961
Non-trainable params: 1,312
__________________________________________________________________________________________________
## ERR: number of trainable params 40459961 exceeded limit 20000000

Train accuracy: 0



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 40413208
OPT eval latency = 0.007909997999999996
OPT eval accuracy_drop = 1
OPT eval energy = 964.3595229534623
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 416]
rem 3
Added Caps1_layer
[None, 2, 2, 1088]
rem 2
Added Caps2_layer
[None, 2, 2, 168]
rem 1
Added Caps3_layer
[None, 2, 2, 168]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   1327136     batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 2, 2, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 2, 2, 168)    1645224     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 2, 2, 168)    0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 168, 4)       0           lambda_3[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        26880       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 40,461,273
Trainable params: 40,459,961
Non-trainable params: 1,312
__________________________________________________________________________________________________
## ERR: number of trainable params 40459961 exceeded limit 20000000

Train accuracy: 0



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 40413208
OPT eval latency = 0.007909997999999996
OPT eval accuracy_drop = 1
OPT eval energy = 964.3595229534623
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 64, 1], [1, 14, 64, 1, 9, 1, 14, 8, 19], [1, 14, 8, 19, 5, 2, 7, 16, 36], [1, 7, 16, 36, 5, 2, 4, 4, 52], [1, 4, 4, 52, 3, 1, 4, 16, 64], [1, 4, 16, 64, 4, 2, 2, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 152]
rem 4
Added Caps1_layer
[None, 7, 7, 576]
rem 3
Added Caps2_layer
[None, 4, 4, 208]
rem 2
Added Caps3_layer
[None, 4, 4, 1024]
rem 1
Added Caps4_layer
[None, 4, 4, 1024]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   4672        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 152)  788120      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 152)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 576)    2189376     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 7, 7, 576)    0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 208)    2995408     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 4, 4, 208)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 1024)   1917952     lambda_3[0][0]                   
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 4, 4, 1024)   0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1024, 16)     0           lambda_4[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       5242880     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 13,423,593
Trainable params: 13,423,417
Non-trainable params: 176
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1503df5a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5327447113946508

Train accuracy: 0.5327447113946508



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 13242216
OPT eval latency = 0.0025877219999999998
OPT eval accuracy_drop = 0.46725528860534915
OPT eval energy = 45.65827069279679
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 64, 1], [1, 14, 64, 1, 9, 1, 14, 8, 19], [1, 14, 8, 19, 5, 2, 7, 16, 36], [1, 7, 16, 36, 5, 2, 4, 4, 52], [1, 4, 4, 52, 4, 2, 2, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 152]
rem 3
Added Caps1_layer
[None, 7, 7, 576]
rem 2
Added Caps2_layer
[None, 4, 4, 208]
rem 1
Added Caps3_layer
[None, 4, 4, 208]
[None, None, 4]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   4672        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 152)  788120      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 152)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 576)    2189376     lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 7, 7, 576)    0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 208)    2995408     lambda_2[0][0]                   
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 4, 4, 208)    0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 832, 4)       0           lambda_3[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       1064960     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 7,327,721
Trainable params: 7,327,545
Non-trainable params: 176
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 155f4ab60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6728096360455842

Train accuracy: 0.6728096360455842



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 7080680
OPT eval latency = 0.0014225700000000004
OPT eval accuracy_drop = 0.3271903639544158
OPT eval energy = 42.62491780831679
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 8]
Added Conv3_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 7, 7, 32, 4]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 4, 4, 32, 8]
[None, 4, 4, 32, 8]
[None, 512, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2308        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 8)    32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 7, 7, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 7, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 4, 4, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 4, 4, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        655440      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 7,425,405
Trainable params: 7,425,221
Non-trainable params: 184
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 15d7c8e20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8115654520819147

Train accuracy: 0.8115654520819147



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8476844
OPT eval latency = 0.0019071810000000008
OPT eval accuracy_drop = 0.18843454791808534
OPT eval energy = 21.55297343447521
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 1, 14, 32, 4], [2, 14, 32, 4, 3, 2, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 3, 1, 7, 32, 8], [2, 7, 32, 8, 7, 1, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 8]
Added Conv3_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 14, 14, 32, 4]
Added CapsCell_layer

[None, 7, 7, 32, 8]
Added CapsCell_layer

[None, 7, 7, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 7, 7, 32, 8]
[None, 7, 7, 32, 8]
[None, 1568, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2308        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 8)    32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 14, 14, 32, 4 9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 14, 14, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 14, 14, 32, 4 147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 14, 14, 32, 4 147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 14, 14, 32, 4 0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 7, 7, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 7, 7, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 7, 7, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 7, 7, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 7, 7, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 1568, 8)      0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 1568, 8)      0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 3136, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        2007120     concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,777,085
Trainable params: 8,776,901
Non-trainable params: 184
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1651e1900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5896262718093258

Train accuracy: 0.5896262718093258



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 9216044
OPT eval latency = 0.0023951249999999993
OPT eval accuracy_drop = 0.4103737281906742
OPT eval energy = 24.765881910264
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [1, 28, 4, 1, 5, 2, 14, 16, 12], [1, 14, 16, 12, 9, 2, 7, 8, 8], [1, 7, 8, 8, 7, 2, 4, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 192]
rem 2
Added Caps1_layer
[None, 7, 7, 64]
rem 1
Added Caps2_layer
[None, 7, 7, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    1300        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 192)  19392       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 192)  0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     995392      lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 7, 7, 64)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 392, 8)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 3,559,257
Trainable params: 3,559,193
Non-trainable params: 64
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 16b36f8c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8570723047155657

Train accuracy: 0.8570723047155657



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 3049496
OPT eval latency = 0.0006368339999999999
OPT eval accuracy_drop = 0.14292769528443428
OPT eval energy = 12.558766209532804
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
Added Conv3_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 4)    1300        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,586,393
Trainable params: 8,586,329
Non-trainable params: 64
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 17067cea0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8099341764386088

Train accuracy: 0.8099341764386088



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 8134728
OPT eval latency = 0.0015731700000000007
OPT eval accuracy_drop = 0.19006582356139123
OPT eval energy = 0.2231551539936

Evaluation of current population completed

gen  1
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 8], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '062325fe0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2001158416149278, 'energy': 36.27826681387202, 'latency': 0.0011241780000000004, 'memory': 5719816}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]], 'runid': '15d7c8e20ec811ee974b218c4823db5d', 'accuracy_drop': 0.18843454791808534, 'energy': 21.55297343447521, 'latency': 0.0019071810000000008, 'memory': 8476844}
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is7
 len_gene is10
gene[layer][1]=4
layer is5
 len_gene is10
range(7, 7)
Fixing...
layer is7
 len_gene is10
gene[layer][1]=4
layer is4
 len_gene is10
[-1]
Fixed.
mute_type = 1
Fixing...
layer is6
 len_gene is9
gene[layer][1]=4
layer is4
 len_gene is9
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 3, 2, 2, 32, 4], [2, 2, 32, 4, 5, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]], 'runid': '106304120ec811ee974b218c4823db5d', 'accuracy_drop': 0.0887434235662552, 'energy': 55.76088528211679, 'latency': 0.003784484999999998, 'memory': 19466728}
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is12
 len_gene is15
gene[layer][1]=2
layer is10
 len_gene is15
range(12, 12)
Fixing...
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
[-1]
Fixed.
mute_type = 0
layer is12
 len_gene is15
gene[layer][1]=2
layer is10
 len_gene is15
range(12, 12)
Fixing...
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]], 'runid': '13588e3a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.2933676873295584, 'energy': 22.05441588851041, 'latency': 0.001721409, 'memory': 8539884}
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is8
 len_gene is11
gene[layer][1]=2
layer is5
 len_gene is11
[-1]
Fixing...
layer is8
 len_gene is11
gene[layer][1]=2
layer is5
 len_gene is11
[-1]
Fixed.
mute_type = 0
layer is8
 len_gene is11
gene[layer][1]=2
layer is6
 len_gene is11
range(8, 8)
Fixing...
layer is8
 len_gene is11
gene[layer][1]=4
layer is5
 len_gene is11
[-1]
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 1, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        282240      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 675,500
Trainable params: 675,084
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 176e80420ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8946194727566856

Train accuracy: 0.8946194727566856



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 589456
OPT eval latency = 0.00024726600000000016
OPT eval accuracy_drop = 0.10538052724331437
OPT eval energy = 0.8032776631775999
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 1, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        141120      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 503,020
Trainable params: 502,604
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 17d24a140ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5519338806871164

Train accuracy: 0.5519338806871164



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 447616
OPT eval latency = 0.000220674
OPT eval accuracy_drop = 0.44806611931288365
OPT eval energy = 0.7999018406879999
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,585,077
Trainable params: 8,585,021
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1829fac00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8834089160693255

Train accuracy: 0.8834089160693255



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 8133428
OPT eval latency = 0.0015634740000000007
OPT eval accuracy_drop = 0.11659108393067452
OPT eval energy = 0.21077717833919998
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,585,077
Trainable params: 8,585,021
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1876dd720ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.935537677055087

Train accuracy: 0.935537677055087



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 8133428
OPT eval latency = 0.0015634740000000007
OPT eval accuracy_drop = 0.06446232294491305
OPT eval energy = 0.21077717833919998
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 8]
Added Conv3_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 7, 7, 32, 4]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 4, 4, 32, 8]
[None, 4, 4, 32, 8]
[None, 512, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2308        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 8)    32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 7, 7, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 7, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 4, 4, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 4, 4, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        655440      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 7,425,405
Trainable params: 7,425,221
Non-trainable params: 184
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 18f1ad540ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7774343684485305

Train accuracy: 0.7774343684485305



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8476844
OPT eval latency = 0.0019071810000000008
OPT eval accuracy_drop = 0.22256563155146947
OPT eval energy = 21.55297343447521
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 2, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 8]
Added Conv3_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 7, 7, 32, 4]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 4, 4, 32, 8]
[None, 4, 4, 32, 8]
[None, 512, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2308        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 8)    32          conv2d_3[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 7, 7, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 7, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 4, 4, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 4, 4, 32, 8)  18688       conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_11[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 512, 8)       0           add_3[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 512, 8)       0           add_3[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        655440      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 5,066,109
Trainable params: 5,065,925
Non-trainable params: 184
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1963abe80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7183620147910224

Train accuracy: 0.7183620147910224



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 6109356
OPT eval latency = 0.0014141250000000005
OPT eval accuracy_drop = 0.28163798520897765
OPT eval energy = 16.86840893399521
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 9, 2, 2, 32, 4], [2, 2, 32, 4, 5, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 8]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 8)    41480       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 8)    32          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   12864       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  331776      convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  819200      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 21,670,089
Trainable params: 21,669,657
Non-trainable params: 432
__________________________________________________________________________________________________
## ERR: number of trainable params 21669657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 23300584
OPT eval latency = 0.004503332999999998
OPT eval accuracy_drop = 1
OPT eval energy = 85.05304336355043
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 16], [0, 14, 8, 16, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 9, 2, 2, 32, 4], [2, 2, 32, 4, 5, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 128]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 128)  663680      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 128)  512         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   204864      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  331776      convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  819200      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  1638400     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 22,484,769
Trainable params: 22,484,097
Non-trainable params: 672
__________________________________________________________________________________________________
## ERR: number of trainable params 22484097 exceeded limit 20000000

Train accuracy: 0



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 24115744
OPT eval latency = 0.004726676999999999
OPT eval accuracy_drop = 1
OPT eval energy = 88.71452970674403
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 2, 7, 8, 1], [2, 7, 8, 1, 3, 2, 4, 32, 4], [2, 4, 32, 4, 3, 2, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 5, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 4]
Added Conv3_layer
[None, 7, 7, 8]
Added Conv4_layer
ConvertToCaps0
[None, 7, 7, 8, 1]
Added CapsCell_layer

[None, 4, 4, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   331840      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 4)    2308        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 8)      2600        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 8)      32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 7, 7, 8, 1)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 4, 4, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 4, 4, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 4, 4, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  1638400     add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  1638400     conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  1638400     conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 10,411,709
Trainable params: 10,411,397
Non-trainable params: 312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1b1d03f80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6123034776904925

Train accuracy: 0.6123034776904925



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 18108140
OPT eval latency = 0.003515457
OPT eval accuracy_drop = 0.38769652230950746
OPT eval energy = 215.92701346378087
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 64, 1], [0, 14, 64, 1, 3, 1, 14, 4, 1], [0, 14, 4, 1, 9, 1, 14, 8, 1], [2, 14, 8, 1, 3, 2, 7, 32, 4], [2, 7, 32, 4, 3, 2, 4, 32, 8], [2, 4, 32, 8, 3, 1, 4, 32, 8], [2, 4, 32, 8, 5, 1, 4, 32, 8], [2, 4, 32, 8, 4, 1, 4, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 64]
Added Conv2_layer
[None, 14, 14, 4]
Added Conv3_layer
[None, 14, 14, 8]
Added Conv4_layer
ConvertToCaps0
[None, 14, 14, 8, 1]
Added CapsCell_layer

[None, 7, 7, 32, 4]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Added CapsCell_layer

[None, 4, 4, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 4, 4, 32, 8]
[None, 4, 4, 32, 8]
[None, 512, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   331840      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 4)    2308        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 4)    16          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 8)    2600        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 8)    32          conv2d_4[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 14, 14, 8, 1) 0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 7, 7, 32, 4)  9216        convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 7, 7, 32, 4)  147456      conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 7, 7, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 4, 4, 32, 8)  294912      add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 4, 4, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 4, 4, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 4, 4, 32, 8)  1638400     add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 4, 4, 32, 8)  1638400     conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 4, 4, 32, 8)  1638400     conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 4, 4, 32, 8)  18688       conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 4, 4, 32, 8)  0           conv2d_caps_15[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 512, 8)       0           add_4[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024, 8)      0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        655440      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 10,903,229
Trainable params: 10,902,917
Non-trainable params: 312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1b9d1bb00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8475337349940959

Train accuracy: 0.8475337349940959



HW Estimator

9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 18376940
OPT eval latency = 0.003688221000000001
OPT eval accuracy_drop = 0.1524662650059041
OPT eval energy = 218.35932024660963

Evaluation of current population completed

gen  2
{'gene': [[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 16], [0, 14, 8, 16, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 9, 2, 2, 32, 4], [2, 2, 32, 4, 5, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]], 'runid': '106304120ec811ee974b218c4823db5d', 'accuracy_drop': 0.0887434235662552, 'energy': 55.76088528211679, 'latency': 0.003784484999999998, 'memory': 19466728}
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
mute_type = 0
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
range(12, 12)
Fixing...
layer is12
 len_gene is15
gene[layer][1]=2
layer is5
 len_gene is15
[-1]
Fixed.
mute_type = 1
Fixing...
layer is11
 len_gene is14
gene[layer][1]=2
layer is5
 len_gene is14
[-1]
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '1829fac00ec811ee974b218c4823db5d', 'accuracy_drop': 0.11659108393067452, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '1829fac00ec811ee974b218c4823db5d', 'accuracy_drop': 0.11659108393067452, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 1, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [0, 28, 4, 1, 9, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '17067cea0ec811ee974b218c4823db5d', 'accuracy_drop': 0.19006582356139123, 'energy': 0.2231551539936, 'latency': 0.0015731700000000007, 'memory': 8134728}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 16], [0, 14, 8, 16, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 9, 2, 2, 32, 4], [2, 2, 32, 4, 9, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 128]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 128)  663680      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 128)  512         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   204864      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  331776      convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  2654208     add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_24 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_23[0][0]             
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_24[0][0]             
                                                                 conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv2d_caps_25 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_6[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_26 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
conv2d_caps_27 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_26[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_25[0][0]             
__________________________________________________________________________________________________
add_7 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_27[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_7[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 35,329,825
Trainable params: 35,329,153
Non-trainable params: 672
__________________________________________________________________________________________________
## ERR: number of trainable params 35329153 exceeded limit 20000000

Train accuracy: 0



HW Estimator

13
12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 36960800
OPT eval latency = 0.007135125000000005
OPT eval accuracy_drop = 1
OPT eval energy = 315.20212417079455
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 64, 1], [0, 28, 64, 1, 9, 2, 14, 8, 16], [0, 14, 8, 16, 5, 1, 14, 4, 16], [0, 14, 4, 16, 5, 2, 7, 32, 1], [0, 7, 32, 1, 5, 2, 4, 32, 1], [2, 4, 32, 1, 9, 2, 2, 32, 4], [2, 2, 32, 4, 9, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 3, 1, 2, 32, 8], [2, 2, 32, 8, 2, 1, 2, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 14, 14, 128]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 32]
Added Conv5_layer
ConvertToCaps0
[None, 4, 4, 32, 1]
Added CapsCell_layer

[None, 2, 2, 32, 4]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Added CapsCell_layer

[None, 2, 2, 32, 8]
Tensor("conv_capsule_layer3d_1/stack:0", shape=(5,), dtype=int32)
Added CapsCell_layer

[None, 2, 2, 32, 8]
[None, 2, 2, 32, 8]
[None, 128, 8]
Added FlattenCaps_layer

[None, 10, 8]
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_1 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 128)  663680      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 128)  512         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   204864      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     51232       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 32)     25632       batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 4, 4, 32)     128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
convert_to_caps_1 (ConvertToCap (None, 4, 4, 32, 1)  0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_caps_1 (Conv2DCaps)      (None, 2, 2, 32, 4)  331776      convert_to_caps_1[0][0]          
__________________________________________________________________________________________________
conv2d_caps_3 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
conv2d_caps_4 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_3[0][0]              
__________________________________________________________________________________________________
conv2d_caps_2 (Conv2DCaps)      (None, 2, 2, 32, 4)  1327104     conv2d_caps_1[0][0]              
__________________________________________________________________________________________________
add_1 (Add)                     (None, 2, 2, 32, 4)  0           conv2d_caps_4[0][0]              
                                                                 conv2d_caps_2[0][0]              
__________________________________________________________________________________________________
conv2d_caps_5 (Conv2DCaps)      (None, 2, 2, 32, 8)  2654208     add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_7 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
conv2d_caps_8 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_7[0][0]              
__________________________________________________________________________________________________
conv2d_caps_6 (Conv2DCaps)      (None, 2, 2, 32, 8)  5308416     conv2d_caps_5[0][0]              
__________________________________________________________________________________________________
add_2 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_8[0][0]              
                                                                 conv2d_caps_6[0][0]              
__________________________________________________________________________________________________
conv2d_caps_9 (Conv2DCaps)      (None, 2, 2, 32, 8)  589824      add_2[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_11 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
conv2d_caps_12 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_11[0][0]             
__________________________________________________________________________________________________
conv2d_caps_10 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_9[0][0]              
__________________________________________________________________________________________________
add_3 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_12[0][0]             
                                                                 conv2d_caps_10[0][0]             
__________________________________________________________________________________________________
conv2d_caps_13 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_15 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
conv2d_caps_16 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_15[0][0]             
__________________________________________________________________________________________________
conv2d_caps_14 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_13[0][0]             
__________________________________________________________________________________________________
add_4 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_16[0][0]             
                                                                 conv2d_caps_14[0][0]             
__________________________________________________________________________________________________
conv2d_caps_17 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_4[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_19 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
conv2d_caps_20 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_19[0][0]             
__________________________________________________________________________________________________
conv2d_caps_18 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_17[0][0]             
__________________________________________________________________________________________________
add_5 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_20[0][0]             
                                                                 conv2d_caps_18[0][0]             
__________________________________________________________________________________________________
conv2d_caps_21 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_caps_22 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
conv2d_caps_23 (Conv2DCaps)     (None, 2, 2, 32, 8)  589824      conv2d_caps_22[0][0]             
__________________________________________________________________________________________________
conv_capsule_layer3d_1 (ConvCap (None, 2, 2, 32, 8)  18688       conv2d_caps_21[0][0]             
__________________________________________________________________________________________________
add_6 (Add)                     (None, 2, 2, 32, 8)  0           conv2d_caps_23[0][0]             
                                                                 conv_capsule_layer3d_1[0][0]     
__________________________________________________________________________________________________
flatten_caps_1 (FlattenCaps)    (None, 128, 8)       0           add_6[0][0]                      
__________________________________________________________________________________________________
flatten_caps_2 (FlattenCaps)    (None, 128, 8)       0           add_6[0][0]                      
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 256, 8)       0           flatten_caps_1[0][0]             
                                                                 flatten_caps_2[0][0]             
__________________________________________________________________________________________________
digit_caps (DClassCaps)         (None, 10, 8)        163920      concatenate_1[0][0]              
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digit_caps[0][0]                 
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digit_caps[0][0]                 
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,970,529
Trainable params: 32,969,857
Non-trainable params: 672
__________________________________________________________________________________________________
## ERR: number of trainable params 32969857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

12
11
10
9
8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 34593312
OPT eval latency = 0.006678933000000004
OPT eval accuracy_drop = 1
OPT eval energy = 310.86780748343466
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,187,637
Trainable params: 2,187,581
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1d17ad8e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5517434071955493

Train accuracy: 0.5517434071955493



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 2108468
OPT eval latency = 0.000433794
OPT eval accuracy_drop = 0.44825659280445074
OPT eval energy = 0.06736565795519997
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   2368        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,169,205
Trainable params: 2,169,149
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1d7562c60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5410399916005771

Train accuracy: 0.5410399916005771



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 2090036
OPT eval latency = 0.000430338
OPT eval accuracy_drop = 0.45896000839942286
OPT eval energy = 0.05994832440000001
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   4672        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,201
Trainable params: 2,171,153
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1dc67b0c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8261275822092331

Train accuracy: 0.8261275822092331



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 2092048
OPT eval latency = 0.00041421
OPT eval accuracy_drop = 0.1738724177907669
OPT eval energy = 0.054514887216000014
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,009
Trainable params: 1,162,961
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1e0b0a060ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8653190581651242

Train accuracy: 0.8653190581651242



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317936
OPT eval latency = 0.0011315220000000003
OPT eval accuracy_drop = 0.13468094183487578
OPT eval energy = 0.1442523792864
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 72]
rem 1
Added Caps1_layer
[None, 4, 4, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 288, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        46080       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 407,980
Trainable params: 407,564
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1e710b300ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5382965831736782

Train accuracy: 0.5382965831736782



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 345976
OPT eval latency = 0.00019845000000000008
OPT eval accuracy_drop = 0.46170341682632177
OPT eval energy = 0.7666361823455999
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 5, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 4, 4, 72]
rem 1
Added Caps1_layer
[None, 4, 4, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   102464      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 4, 4, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 288, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        46080       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 473,516
Trainable params: 473,100
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1ed591720ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7603277228098246

Train accuracy: 0.7603277228098246



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 411512
OPT eval latency = 0.00021073800000000008
OPT eval accuracy_drop = 0.23967227719017536
OPT eval energy = 1.0110717325536
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 9, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    2596        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   20800       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,587,381
Trainable params: 8,587,325
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1f2dc2840ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9022196431907734

Train accuracy: 0.9022196431907734



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 8135732
OPT eval latency = 0.0015639060000000008
OPT eval accuracy_drop = 0.09778035680922659
OPT eval energy = 0.2519904697824001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 64)   41536       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,605,505
Trainable params: 8,605,457
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1f7460cc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5134202764047422

Train accuracy: 0.5134202764047422



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 8153872
OPT eval latency = 0.0015508020000000006
OPT eval accuracy_drop = 0.4865797235952578
OPT eval energy = 0.2270239037664

Evaluation of current population completed

gen  3
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 5, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 3, 1, 2, 4, 42], [1, 2, 4, 42, 2, 1, 2, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 1, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 4], [0, 28, 64, 4, 3, 2, 14, 32, 1], [1, 14, 32, 1, 9, 2, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 32, 1], [1, 14, 32, 1, 9, 2, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 32]
Added Conv3_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 32)   18464       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 32)   128         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 72)     186696      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        141120      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 465,836
Trainable params: 465,548
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 1fd526d20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8047436349744392

Train accuracy: 0.8047436349744392



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 410688
OPT eval latency = 0.000204306
OPT eval accuracy_drop = 0.19525636502556076
OPT eval energy = 0.7601887515359999
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 4], [0, 28, 64, 4, 3, 2, 14, 32, 1], [1, 14, 32, 1, 9, 2, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 256]
Added Conv2_layer
[None, 14, 14, 32]
Added Conv3_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 256)  205056      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 256)  1024        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 32)   73760       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 32)   128         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 72)     186696      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        141120      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 675,692
Trainable params: 675,020
Non-trainable params: 672
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 203306580ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7413424678770841

Train accuracy: 0.7413424678770841



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 619872
OPT eval latency = 0.00035637000000000017
OPT eval accuracy_drop = 0.25865753212291587
OPT eval energy = 2.312611380912001
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 9, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 416]
rem 2
Added Caps1_layer
[None, 2, 2, 1088]
rem 1
Added Caps2_layer
[None, 2, 2, 1088]
[None, None, 64]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   1327136     batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 2, 2, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 68, 64)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        174080      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 38,963,249
Trainable params: 38,961,937
Non-trainable params: 1,312
__________________________________________________________________________________________________
## ERR: number of trainable params 38961937 exceeded limit 20000000

Train accuracy: 0



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 38923496
OPT eval latency = 0.007617486000000001
OPT eval accuracy_drop = 1
OPT eval energy = 951.4289895343007
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 2, 1, 2, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 416]
rem 2
Added Caps1_layer
[None, 2, 2, 1088]
rem 1
Added Caps2_layer
[None, 2, 2, 1088]
[None, None, 64]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 416)    666016      batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 416)    0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 2, 2, 1088)   36662336    lambda_1[0][0]                   
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 2, 2, 1088)   0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 68, 64)       0           lambda_2[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        174080      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 37,783,601
Trainable params: 37,782,289
Non-trainable params: 1,312
__________________________________________________________________________________________________
## ERR: number of trainable params 37782289 exceeded limit 20000000

Train accuracy: 0



HW Estimator

8
7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 37743848
OPT eval latency = 0.007396302
OPT eval accuracy_drop = 1
OPT eval energy = 872.5201306420128
### EVAL candidate 4/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 1, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 32]
Added Conv4_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 32)     18464       batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 32)     128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 72)     186696      batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        282240      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 675,500
Trainable params: 675,084
Non-trainable params: 416
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 216415940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.642812677243416

Train accuracy: 0.642812677243416



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 589456
OPT eval latency = 0.00024726600000000016
OPT eval accuracy_drop = 0.35718732275658405
OPT eval energy = 0.8032776631775999
### EVAL candidate 5/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [1, 14, 64, 1, 9, 1, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 14, 14, 72]
rem 1
Added Caps1_layer
[None, 14, 14, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 72)   373320      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 72)   0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3528, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1128960     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 1,690,252
Trainable params: 1,689,900
Non-trainable params: 352
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 21c18de60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5879933826333718

Train accuracy: 0.5879933826333718



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 1633736
OPT eval latency = 0.0004665300000000001
OPT eval accuracy_drop = 0.41200661736662825
OPT eval energy = 2.495126667619201
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 72]
rem 1
Added Caps1_layer
[None, 14, 14, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 72)   186696      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3528, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        564480      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 828,460
Trainable params: 828,300
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 221945360ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7425126066034322

Train accuracy: 0.7425126066034322



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 802968
OPT eval latency = 0.000254274
OPT eval accuracy_drop = 0.2574873933965678
OPT eval energy = 0.6385487077344002
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 9, 2, 28, 4, 18], [1, 28, 4, 18, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 28, 28, 72]
rem 1
Added Caps1_layer
[None, 28, 28, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 72)   186696      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 14112, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2257920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 2,521,900
Trainable params: 2,521,740
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 22660ee80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5697372750028227

Train accuracy: 0.5697372750028227



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 2614008
OPT eval latency = 0.000876114
OPT eval accuracy_drop = 0.4302627249971773
OPT eval energy = 1.5128809832160004
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 1, 28, 4, 1], [1, 28, 4, 1, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 4]
Added Conv2_layer
[None, 28, 28, 4]
[None, None, 4]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 4)       0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 2,543,157
Trainable params: 2,543,101
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 22be0ca60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6880256677951915

Train accuracy: 0.6880256677951915



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 2165428
OPT eval latency = 0.0008682900000000001
OPT eval accuracy_drop = 0.3119743322048085
OPT eval energy = 0.1152953567712
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 4, 1], [1, 14, 4, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 14, 14, 4]
Added Conv2_layer
[None, 14, 14, 4]
[None, None, 4]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 4)    292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 4)    16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 4)       0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,037,877
Trainable params: 1,037,821
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 231310fc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.727658907543328

Train accuracy: 0.727658907543328



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 542548
OPT eval latency = 0.00021913800000000007
OPT eval accuracy_drop = 0.27234109245667204
OPT eval energy = 0.029558295907199997

Evaluation of current population completed

gen  4
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [0, 14, 64, 1, 3, 2, 7, 32, 1], [1, 7, 32, 1, 9, 2, 4, 4, 18], [1, 4, 4, 18, 4, 1, 4, 10, 4], [-1], [2]], 'runid': '1e710b300ec811ee974b218c4823db5d', 'accuracy_drop': 0.46170341682632177, 'energy': 0.7666361823455999, 'latency': 0.00019845000000000008, 'memory': 345976}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 4], [-1], [2]], 'runid': '221945360ec811ee974b218c4823db5d', 'accuracy_drop': 0.2574873933965678, 'energy': 0.6385487077344002, 'latency': 0.000254274, 'memory': 802968}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 64, 1], [1, 28, 64, 1, 9, 2, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 4], [-1], [2]], 'runid': '1e710b300ec811ee974b218c4823db5d', 'accuracy_drop': 0.46170341682632177, 'energy': 0.7666361823455999, 'latency': 0.00019845000000000008, 'memory': 345976}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 9, 2, 28, 4, 18], [1, 28, 4, 18, 28, 1, 28, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '1dc67b0c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.1738724177907669, 'energy': 0.054514887216000014, 'latency': 0.00041421, 'memory': 2092048}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [1, 14, 64, 1, 9, 2, 7, 4, 18], [1, 7, 4, 18, 7, 1, 7, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 14, 14, 64]
Added Conv3_layer
[None, 7, 7, 72]
rem 1
Added Caps1_layer
[None, 7, 7, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 72)     373320      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 72)     0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 882, 4)       0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        141120      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 671,052
Trainable params: 670,700
Non-trainable params: 352
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 237140d20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7932251014420998

Train accuracy: 0.7932251014420998



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 615776
OPT eval latency = 0.00024745800000000015
OPT eval accuracy_drop = 0.2067748985579002
OPT eval energy = 1.9231888116192004
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 1, 28, 64, 1], [1, 28, 64, 1, 9, 2, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 28, 28, 64]
Added Conv3_layer
[None, 14, 14, 72]
rem 1
Added Caps1_layer
[None, 14, 14, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 64)   36928       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 64)   256         conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 72)   373320      batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 72)   0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3528, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        564480      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 1,094,412
Trainable params: 1,094,060
Non-trainable params: 352
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 23c4b7da0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7603611372705851

Train accuracy: 0.7603611372705851



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 1068536
OPT eval latency = 0.0004734420000000001
OPT eval accuracy_drop = 0.23963886272941493
OPT eval energy = 2.7555876265440014
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 16], [1, 14, 4, 16, 14, 1, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   165952      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 744,996
Trainable params: 744,836
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2420a3c40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7774461268135886

Train accuracy: 0.7774461268135886



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 719424
OPT eval latency = 0.00023862600000000003
OPT eval accuracy_drop = 0.2225538731864114
OPT eval energy = 0.5991986946528003
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 9, 2, 28, 4, 16], [1, 28, 4, 16, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
rem 1
Added Caps1_layer
[None, 28, 28, 64]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   165952      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 64)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 2,240,900
Trainable params: 2,240,804
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2471dbd60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8526815941777222

Train accuracy: 0.8526815941777222



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 2333056
OPT eval latency = 0.0005223539999999999
OPT eval accuracy_drop = 0.14731840582227784
OPT eval energy = 1.0913819499744002
### EVAL candidate 4/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 64, 1], [1, 56, 64, 1, 9, 2, 28, 4, 18], [1, 28, 4, 18, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 28, 28, 72]
rem 1
Added Caps1_layer
[None, 28, 28, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   18496       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 72)   373320      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 14112, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2257920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 2,717,900
Trainable params: 2,717,676
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 24beb7e40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5687947326834943

Train accuracy: 0.5687947326834943



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 2809880
OPT eval latency = 0.0009880980000000002
OPT eval accuracy_drop = 0.43120526731650566
OPT eval energy = 4.721164397155201
### EVAL candidate 5/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 9, 2, 28, 4, 18], [1, 28, 4, 18, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 72]
rem 1
Added Caps1_layer
[None, 28, 28, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 72)   186696      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 72)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 14112, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2257920     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 2,512,524
Trainable params: 2,512,428
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2512750a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.873631091881452

Train accuracy: 0.873631091881452



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 2604760
OPT eval latency = 0.0005732819999999999
OPT eval accuracy_drop = 0.12636890811854795
OPT eval energy = 1.1352107167200003
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   186696      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        9031680     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 9,295,660
Trainable params: 9,295,500
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 25697d500ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6315365786749287

Train accuracy: 0.6315365786749287



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 9858168
OPT eval latency = 0.002460066000000001
OPT eval accuracy_drop = 0.36846342132507126
OPT eval energy = 3.8838135159264
### EVAL candidate 7/10
[[0, 56, 1, 1, 3, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   186696      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        9031680     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 9,293,356
Trainable params: 9,293,196
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 25b64f900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6841129280693055

Train accuracy: 0.6841129280693055



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 9855864
OPT eval latency = 0.002459634000000001
OPT eval accuracy_drop = 0.31588707193069454
OPT eval energy = 3.88134227064
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,009
Trainable params: 1,162,961
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 260834c20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9193321481419483

Train accuracy: 0.9193321481419483



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317936
OPT eval latency = 0.0011315220000000003
OPT eval accuracy_drop = 0.0806678518580517
OPT eval energy = 0.1442523792864
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,293,457
Trainable params: 32,292,913
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32292913 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32452352
OPT eval latency = 0.006087186
OPT eval accuracy_drop = 1
OPT eval energy = 0.7742901795551999

Evaluation of current population completed

gen  5
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 4, 1], [1, 14, 4, 1, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '231310fc0ec811ee974b218c4823db5d', 'accuracy_drop': 0.27234109245667204, 'energy': 0.029558295907199997, 'latency': 0.00021913800000000007, 'memory': 542548}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [0, 28, 64, 1, 3, 2, 14, 64, 1], [1, 14, 64, 1, 9, 1, 14, 4, 18], [1, 14, 4, 18, 14, 1, 14, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [0, 28, 8, 1, 3, 2, 14, 4, 1], [1, 14, 4, 1, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '231310fc0ec811ee974b218c4823db5d', 'accuracy_drop': 0.27234109245667204, 'energy': 0.029558295907199997, 'latency': 0.00021913800000000007, 'memory': 542548}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,889
Trainable params: 4,549,841
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 26980d900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5643686769796024

Train accuracy: 0.5643686769796024



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328976
OPT eval latency = 0.0016960980000000005
OPT eval accuracy_drop = 0.43563132302039764
OPT eval energy = 0.2159246249952
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,291,969
Trainable params: 2,291,921
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 26e934d60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8552338471362939

Train accuracy: 0.8552338471362939



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2321616
OPT eval latency = 0.0013197300000000005
OPT eval accuracy_drop = 0.1447661528637061
OPT eval energy = 0.1681451590368
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 2, 28, 64, 1], [1, 28, 64, 1, 9, 1, 28, 4, 18], [1, 28, 4, 18, 28, 1, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
Added Conv2_layer
[None, 28, 28, 72]
rem 1
Added Caps1_layer
[None, 28, 28, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 28, 28, 72)   373320      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 14112, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4515840     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 5,039,948
Trainable params: 5,039,724
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 274046ea0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6114280145707247

Train accuracy: 0.6114280145707247



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 5101288
OPT eval latency = 0.0011919540000000007
OPT eval accuracy_drop = 0.3885719854292753
OPT eval energy = 4.661195024457601
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   373320      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        18063360    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 18,587,468
Trainable params: 18,587,244
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 278cffda0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5223375991861205

Train accuracy: 0.5223375991861205



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 19119208
OPT eval latency = 0.004497570000000001
OPT eval accuracy_drop = 0.47766240081387945
OPT eval energy = 14.4657805277664
### EVAL candidate 4/10
[[0, 56, 1, 1, 3, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 5, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   57672       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        9031680     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 9,164,332
Trainable params: 9,164,172
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 27e7c55a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7941925570934754

Train accuracy: 0.7941925570934754



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 9726840
OPT eval latency = 0.002435442000000001
OPT eval accuracy_drop = 0.20580744290652464
OPT eval energy = 1.5862344959712
### EVAL candidate 5/10
[[0, 56, 1, 1, 3, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   20808       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        9031680     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 9,127,468
Trainable params: 9,127,308
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 283eff140ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5663355508980596

Train accuracy: 0.5663355508980596



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 9689976
OPT eval latency = 0.002428530000000001
OPT eval accuracy_drop = 0.43366444910194035
OPT eval energy = 0.9891707713247998
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 3, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 7, 7, 4]
Added Conv2_layer
[None, 7, 7, 4]
[None, None, 4]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 7, 7, 4)      292         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 7, 7, 4)      16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 49, 4)        0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       125440      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 661,557
Trainable params: 661,501
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2889bdb00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8333287946026784

Train accuracy: 0.8333287946026784



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 136828
OPT eval latency = 5.520600000000001e-05
OPT eval accuracy_drop = 0.1666712053973216
OPT eval energy = 0.0074863277088
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 7, 7, 4]
Added Conv2_layer
[None, 7, 7, 4]
[None, None, 4]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 7, 7, 4)      804         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 7, 7, 4)      16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 49, 4)        0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       125440      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 662,069
Trainable params: 662,013
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 28e1d02c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6341557216598305

Train accuracy: 0.6341557216598305



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 137340
OPT eval latency = 5.5302000000000014e-05
OPT eval accuracy_drop = 0.3658442783401695
OPT eval energy = 0.008166377424
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,778,833
Trainable params: 128,777,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128777777 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128826624
OPT eval latency = 0.02415736200000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0692345611487992
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,778,833
Trainable params: 128,777,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128777777 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128826624
OPT eval latency = 0.02415736200000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0692345611487992

Evaluation of current population completed

gen  6
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 3, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 64], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,539,329
Trainable params: 1,539,281
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 29bfb2020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7303811335392646

Train accuracy: 0.7303811335392646



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083216
OPT eval latency = 0.000424254
OPT eval accuracy_drop = 0.2696188664607354
OPT eval energy = 0.0540365562528
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,889
Trainable params: 4,549,841
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2a0e93720ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6527607138403022

Train accuracy: 0.6527607138403022



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328976
OPT eval latency = 0.0016960980000000005
OPT eval accuracy_drop = 0.3472392861596978
OPT eval energy = 0.2159246249952
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,009
Trainable params: 1,162,961
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2a5323660ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5014243895076154

Train accuracy: 0.5014243895076154



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317936
OPT eval latency = 0.0011315220000000003
OPT eval accuracy_drop = 0.49857561049238464
OPT eval energy = 0.1442523792864
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,192,465
Trainable params: 8,192,305
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2aa507120ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5586606031291304

Train accuracy: 0.5586606031291304



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8348288
OPT eval latency = 0.0016264979999999997
OPT eval accuracy_drop = 0.44133939687086965
OPT eval energy = 0.2072991105504
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,346,065
Trainable params: 16,345,905
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2ae977940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7640580088065706

Train accuracy: 0.7640580088065706



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16377728
OPT eval latency = 0.003132018000000001
OPT eval accuracy_drop = 0.2359419911934294
OPT eval energy = 0.39842306792640003
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,778,833
Trainable params: 128,777,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128777777 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128826624
OPT eval latency = 0.02415736200000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0692345611487992
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,750,161
Trainable params: 128,749,105
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128749105 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128797952
OPT eval latency = 0.024151986000000007
OPT eval accuracy_drop = 1
OPT eval energy = 3.066244279420799
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 7, 7, 4]
Added Conv2_layer
[None, 7, 7, 4]
[None, None, 4]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 7, 7, 4)      804         batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 7, 7, 4)      16          conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 49, 4)        0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       62720       reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 348,469
Trainable params: 348,413
Non-trainable params: 56
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2c1ad27a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8170458460299352

Train accuracy: 0.8170458460299352



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 74300
OPT eval latency = 4.349400000000001e-05
OPT eval accuracy_drop = 0.18295415397006476
OPT eval energy = 0.006667365993600001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2c6a573c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7815976405499068

Train accuracy: 0.7815976405499068



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.21840235945009323
OPT eval energy = 0.0420871196064

Evaluation of current population completed

gen  7
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [0, 14, 8, 1, 5, 2, 7, 4, 1], [1, 7, 4, 1, 7, 2, 4, 10, 32], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 9, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   373320      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        18063360    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 18,587,468
Trainable params: 18,587,244
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2cb75d480ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8694827586124125

Train accuracy: 0.8694827586124125



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 19119208
OPT eval latency = 0.004497570000000001
OPT eval accuracy_drop = 0.13051724138758747
OPT eval energy = 14.4657805277664
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 5, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   115272      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        18063360    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 18,329,420
Trainable params: 18,329,196
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2d11f41a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5648332609323695

Train accuracy: 0.5648332609323695



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 18861160
OPT eval latency = 0.004449186000000002
OPT eval accuracy_drop = 0.4351667390676305
OPT eval energy = 5.289273057532801
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 72]
rem 1
Added Caps1_layer
[None, 56, 56, 72]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 72)   20808       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 72)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 56448, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        9031680     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 9,129,772
Trainable params: 9,129,612
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2d695fca0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5338833400049341

Train accuracy: 0.5338833400049341



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 9692280
OPT eval latency = 0.002428962000000001
OPT eval accuracy_drop = 0.4661166599950659
OPT eval energy = 0.9916420166111999
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 128]
rem 1
Added Caps1_layer
[None, 56, 56, 128]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 128)  36992       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 128)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 4)    0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 16,170,596
Trainable params: 16,170,436
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2db64c360ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.579371152777833

Train accuracy: 0.579371152777833



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 16733664
OPT eval latency = 0.003749202000000001
OPT eval accuracy_drop = 0.420628847222167
OPT eval energy = 1.1626323222239998
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,539,329
Trainable params: 1,539,281
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2e08d5320ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9271126111122776

Train accuracy: 0.9271126111122776



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083216
OPT eval latency = 0.000424254
OPT eval accuracy_drop = 0.07288738888772239
OPT eval energy = 0.0540365562528
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,539,329
Trainable params: 1,539,281
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2e5795e60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5005014978556664

Train accuracy: 0.5005014978556664



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083216
OPT eval latency = 0.000424254
OPT eval accuracy_drop = 0.49949850214433356
OPT eval energy = 0.0540365562528
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,669,777
Trainable params: 32,669,233
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32669233 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32232512
OPT eval latency = 0.006044382000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7684272639648
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 129,007,697
Trainable params: 129,007,153
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 129007153 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128805632
OPT eval latency = 0.02415342600000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0677776680671993
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2f2b2d480ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6312303945783649

Train accuracy: 0.6312303945783649



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.36876960542163506
OPT eval energy = 0.0420871196064
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2f7bf2960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6281719248248916

Train accuracy: 0.6281719248248916



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.3718280751751084
OPT eval energy = 0.0420871196064

Evaluation of current population completed

gen  8
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 5, 1, 56, 4, 18], [1, 56, 4, 18, 56, 1, 56, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 16], [1, 14, 4, 16, 14, 1, 14, 10, 4], [-1], [2]], 'runid': '2420a3c40ec811ee974b218c4823db5d', 'accuracy_drop': 0.2225538731864114, 'energy': 0.5991986946528003, 'latency': 0.00023862600000000003, 'memory': 719424}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 56, 1, 56, 10, 16], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 56, 56, 64]
[None, None, 64]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 64)     0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 16,207,108
Trainable params: 16,206,884
Non-trainable params: 224
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 2fd103d00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8592402673582842

Train accuracy: 0.8592402673582842



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 26145488
OPT eval latency = 0.033436866
OPT eval accuracy_drop = 0.14075973264171582
OPT eval energy = 5.1814102108128
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 5, 1, 56, 64, 1], [1, 56, 64, 1, 56, 1, 56, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 64]
Added Conv2_layer
[None, 56, 56, 64]
[None, None, 64]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 64)   51264       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 64)   256         conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 64)     0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 32,326,148
Trainable params: 32,325,924
Non-trainable params: 224
__________________________________________________________________________________________________
## ERR: number of trainable params 32325924 exceeded limit 20000000

Train accuracy: 0



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 42201888
OPT eval latency = 0.036447426000000005
OPT eval accuracy_drop = 1
OPT eval energy = 5.563597190140801
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 16], [1, 14, 4, 16, 14, 1, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   165952      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 744,996
Trainable params: 744,836
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 307274c20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7608876761686183

Train accuracy: 0.7608876761686183



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 719424
OPT eval latency = 0.00023862600000000003
OPT eval accuracy_drop = 0.2391123238313817
OPT eval energy = 0.5991986946528003
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 16], [1, 14, 4, 16, 14, 1, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 32]
Added Conv2_layer
[None, 14, 14, 64]
rem 1
Added Caps1_layer
[None, 14, 14, 64]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 28, 28, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 64)   165952      batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 14, 14, 64)   0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 4)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 744,996
Trainable params: 744,836
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 30c9a3e60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6160171718723194

Train accuracy: 0.6160171718723194



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 719424
OPT eval latency = 0.00023862600000000003
OPT eval accuracy_drop = 0.3839828281276806
OPT eval energy = 0.5991986946528003
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 310fc5d80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5072616116756581

Train accuracy: 0.5072616116756581



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.4927383883243419
OPT eval energy = 0.0420871196064
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 316146380ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5550825760962216

Train accuracy: 0.5550825760962216



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.4449174239037784
OPT eval energy = 0.0420871196064
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 16,218,308
Trainable params: 16,218,212
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 31aff4c20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7661721011093672

Train accuracy: 0.7661721011093672



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 21076704
OPT eval latency = 0.018073362000000003
OPT eval accuracy_drop = 0.23382789889063282
OPT eval energy = 2.2968080212704005
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,068
Trainable params: 4,175,972
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 31f49c800ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6666119266403985

Train accuracy: 0.6666119266403985



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 5271264
OPT eval latency = 0.004518786
OPT eval accuracy_drop = 0.3333880733596015
OPT eval energy = 0.5743548669408001
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 129,007,697
Trainable params: 129,007,153
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 129007153 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128805632
OPT eval latency = 0.02415342600000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0677776680671993
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,771,409
Trainable params: 64,771,121
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64771121 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64559616
OPT eval latency = 0.012107298
OPT eval accuracy_drop = 1
OPT eval energy = 1.5380575625184005

Evaluation of current population completed

gen  9
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 5, 2, 4, 32, 13], [1, 4, 32, 13, 9, 2, 2, 64, 17], [1, 2, 64, 17, 2, 1, 2, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,113
Trainable params: 786,065
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 32d5c30e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5248104286968656

Train accuracy: 0.5248104286968656



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 580560
OPT eval latency = 0.00033003000000000004
OPT eval accuracy_drop = 0.47518957130313444
OPT eval energy = 0.041896912464
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 409,793
Trainable params: 409,745
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3327b4480ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5679275014912805

Train accuracy: 0.5679275014912805



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 329520
OPT eval latency = 0.000282942
OPT eval accuracy_drop = 0.43207249850871954
OPT eval energy = 0.035919147369599995
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 5, 2, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 16, 1], [0, 7, 16, 1, 3, 1, 7, 64, 1], [1, 7, 64, 1, 9, 2, 4, 64, 17], [1, 4, 64, 17, 4, 1, 4, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 7, 7, 16]
Added Conv3_layer
[None, 7, 7, 16]
Added Conv4_layer
[None, 7, 7, 64]
Added Conv5_layer
[None, 4, 4, 1088]
rem 1
Added Caps1_layer
[None, 4, 4, 1088]
[None, None, 64]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_6 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 7, 7, 16)     12816       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 7, 7, 16)     64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 16)     2320        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 7, 7, 16)     64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 64)     9280        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 7, 7, 64)     256         conv2d_5[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 4, 4, 1088)   5641280     batch_normalization_5[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 4, 4, 1088)   0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 272, 64)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        696320      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 6,618,769
Trainable params: 6,617,457
Non-trainable params: 1,312
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 353e92f60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8248628501666981

Train accuracy: 0.8248628501666981



HW Estimator

7
6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 6604360
OPT eval latency = 0.0015526380000000003
OPT eval accuracy_drop = 0.17513714983330186
OPT eval energy = 26.86193430734401
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 9, 2, 7, 64, 17], [1, 7, 64, 17, 7, 1, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 64]
Added Conv4_layer
[None, 7, 7, 1088]
rem 1
Added Caps1_layer
[None, 7, 7, 1088]
[None, None, 64]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   4624        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 14, 14, 64)   9280        batch_normalization_3[0][0]      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 14, 14, 64)   256         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 7, 7, 1088)   5641280     batch_normalization_4[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 1088)   0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 833, 64)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2132480     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,044,353
Trainable params: 8,043,073
Non-trainable params: 1,280
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 35a2f6b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.896081665942462

Train accuracy: 0.896081665942462



HW Estimator

6
5
4
3
2
1
0

Parsed gene

OPT eval memory = 8135608
OPT eval latency = 0.0018649740000000008
OPT eval accuracy_drop = 0.10391833405753803
OPT eval energy = 27.026571517123205

Evaluation of current population completed

gen  10
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 9, 2, 14, 4, 16], [1, 14, 4, 16, 14, 1, 14, 10, 4], [-1], [2]], 'runid': '2420a3c40ec811ee974b218c4823db5d', 'accuracy_drop': 0.2225538731864114, 'energy': 0.5991986946528003, 'latency': 0.00023862600000000003, 'memory': 719424}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 16], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 786,689
Trainable params: 786,641
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 35f2cfc80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7127324849375529

Train accuracy: 0.7127324849375529



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581136
OPT eval latency = 0.00033012600000000003
OPT eval accuracy_drop = 0.2872675150624471
OPT eval energy = 0.0420871196064
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32253504
OPT eval latency = 0.006048318000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7698841570463999
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,595,281
Trainable params: 16,594,993
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 36856cd40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8116166653759701

Train accuracy: 0.8116166653759701



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16148288
OPT eval latency = 0.003028590000000001
OPT eval accuracy_drop = 0.1883833346240299
OPT eval energy = 0.384520525968
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 37155ccc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6997527159964587

Train accuracy: 0.6997527159964587



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16150080
OPT eval latency = 0.003029502000000001
OPT eval accuracy_drop = 0.3002472840035413
OPT eval energy = 0.3845916434976
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 37673da80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9052839467868394

Train accuracy: 0.9052839467868394



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16150080
OPT eval latency = 0.003029502000000001
OPT eval accuracy_drop = 0.09471605321316057
OPT eval energy = 0.3845916434976
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 9, 2, 28, 4, 16], [1, 28, 4, 16, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 28, 28, 64]
rem 1
Added Caps1_layer
[None, 28, 28, 64]
[None, None, 4]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 28, 28, 64)   165952      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 28, 28, 64)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 4)     0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 2,240,900
Trainable params: 2,240,804
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 37add3580ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6579689241161523

Train accuracy: 0.6579689241161523



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 2333056
OPT eval latency = 0.0005223539999999999
OPT eval accuracy_drop = 0.34203107588384773
OPT eval energy = 1.0913819499744002
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 4,081,988
Trainable params: 4,081,892
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 37fecb780ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.725181323614993

Train accuracy: 0.725181323614993



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 9034344
OPT eval latency = 0.015815442000000002
OPT eval accuracy_drop = 0.274818676385007
OPT eval energy = 2.0101677867744003
### EVAL candidate 8/10
[[0, 56, 1, 1, 9, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,068
Trainable params: 4,175,972
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 384d79120ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8679048610010048

Train accuracy: 0.8679048610010048



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 5271264
OPT eval latency = 0.004518786
OPT eval accuracy_drop = 0.13209513899899517
OPT eval energy = 0.5743548669408001
### EVAL candidate 9/10
[[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 4,173,764
Trainable params: 4,173,668
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 389210360ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5854496163804738

Train accuracy: 0.5854496163804738



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 5268960
OPT eval latency = 0.004518354
OPT eval accuracy_drop = 0.41455038361952623
OPT eval energy = 0.5735996182752001

Evaluation of current population completed

gen  11
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 4], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 32], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    208         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,441
Trainable params: 4,549,393
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 38e3cd9a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6817100616535443

Train accuracy: 0.6817100616535443



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328528
OPT eval latency = 0.0016960020000000005
OPT eval accuracy_drop = 0.3182899383464557
OPT eval energy = 0.2153938538976
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    208         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,538,881
Trainable params: 1,538,833
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3932bbbc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8825997239731613

Train accuracy: 0.8825997239731613



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1082768
OPT eval latency = 0.000424158
OPT eval accuracy_drop = 0.11740027602683867
OPT eval energy = 0.0538697844384
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
Added Conv2_layer
[None, 56, 56, 128]
rem 1
Added Caps1_layer
[None, 56, 56, 128]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 32)   9248        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 128)  36992       batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 128)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 4)    0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 32,258,276
Trainable params: 32,258,116
Non-trainable params: 160
__________________________________________________________________________________________________
## ERR: number of trainable params 32258116 exceeded limit 20000000

Train accuracy: 0



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 32791264
OPT eval latency = 0.006760002000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.5448497692639998
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 32], [1, 56, 32, 32, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 1024]
Added Conv2_layer
[None, 56, 56, 128]
rem 1
Added Caps1_layer
[None, 56, 56, 128]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 1024) 295936      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 56, 56, 1024) 4096        conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 56, 56, 128)  1179776     batch_normalization_2[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 128)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 4)    0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 33,691,716
Trainable params: 33,689,572
Non-trainable params: 2,144
__________________________________________________________________________________________________
## ERR: number of trainable params 33689572 exceeded limit 20000000

Train accuracy: 0



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 34224704
OPT eval latency = 0.016361442000000007
OPT eval accuracy_drop = 1
OPT eval energy = 373.77821370628806
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,168,273
Trainable params: 8,167,217
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3a221b8a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7704064533998953

Train accuracy: 0.7704064533998953



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8153664
OPT eval latency = 0.001529598
OPT eval accuracy_drop = 0.22959354660010467
OPT eval energy = 0.1962380755104
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,252,753
Trainable params: 32,251,697
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32251697 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32473344
OPT eval latency = 0.006091121999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7757470726367999
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,531,537
Trainable params: 64,530,993
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64530993 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64570112
OPT eval latency = 0.012109266
OPT eval accuracy_drop = 1
OPT eval energy = 1.5387860090592005
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,513,105
Trainable params: 64,512,561
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64512561 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64551680
OPT eval latency = 0.012106098000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.5368546137824004
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 410,369
Trainable params: 410,321
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3b4343540ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9179441803274547

Train accuracy: 0.9179441803274547



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 330096
OPT eval latency = 0.000283038
OPT eval accuracy_drop = 0.08205581967254527
OPT eval energy = 0.036109354512
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    208         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 409,921
Trainable params: 409,873
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3b921dbc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.518471385035058

Train accuracy: 0.518471385035058



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 329648
OPT eval latency = 0.000282942
OPT eval accuracy_drop = 0.48152861496494204
OPT eval energy = 0.0359425826976

Evaluation of current population completed

gen  12
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '260834c20ec811ee974b218c4823db5d', 'accuracy_drop': 0.0806678518580517, 'energy': 0.1442523792864, 'latency': 0.0011315220000000003, 'memory': 1317936}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,009
Trainable params: 1,162,961
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3bd6ebcc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.800018459223732

Train accuracy: 0.800018459223732



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317936
OPT eval latency = 0.0011315220000000003
OPT eval accuracy_drop = 0.19998154077626795
OPT eval energy = 0.1442523792864
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 8]
Added Conv1_layer
[None, 28, 28, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,009
Trainable params: 1,162,961
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3c2896de0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5856109424379259

Train accuracy: 0.5856109424379259



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317936
OPT eval latency = 0.0011315220000000003
OPT eval accuracy_drop = 0.4143890575620741
OPT eval energy = 0.1442523792864
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,538,753
Trainable params: 1,538,705
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3c6d225e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7326634262579217

Train accuracy: 0.7326634262579217



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1082640
OPT eval latency = 0.000424158
OPT eval accuracy_drop = 0.2673365737420783
OPT eval energy = 0.053846349110399996
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,538,753
Trainable params: 1,538,705
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3cbc43840ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9057992814790791

Train accuracy: 0.9057992814790791



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1082640
OPT eval latency = 0.000424158
OPT eval accuracy_drop = 0.09420071852092093
OPT eval energy = 0.053846349110399996
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,513,105
Trainable params: 64,512,561
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64512561 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64551680
OPT eval latency = 0.012106098000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.5368546137824004
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,513,105
Trainable params: 64,512,561
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64512561 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64551680
OPT eval latency = 0.012106098000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.5368546137824004
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,398,673
Trainable params: 32,398,385
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32398385 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32432640
OPT eval latency = 0.006083633999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7723100359391999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,314,193
Trainable params: 8,313,905
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3de84b720ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6554229193823408

Train accuracy: 0.6554229193823408



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112960
OPT eval latency = 0.00152211
OPT eval accuracy_drop = 0.34457708061765924
OPT eval energy = 0.193230037968
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,115,665
Trainable params: 4,115,505
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3e2ce4b20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7976738279242929

Train accuracy: 0.7976738279242929



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4333568
OPT eval latency = 0.0008737620000000001
OPT eval accuracy_drop = 0.20232617207570713
OPT eval energy = 0.11174017863360004
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,111,057
Trainable params: 4,110,897
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3e7ebe9a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9029142851133108

Train accuracy: 0.9029142851133108



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328960
OPT eval latency = 0.0008729460000000002
OPT eval accuracy_drop = 0.09708571488668916
OPT eval energy = 0.11081944716480004

Evaluation of current population completed

gen  13
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 1], [1, 28, 8, 1, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 3, 1, 14, 16, 1], [0, 14, 16, 1, 3, 1, 14, 64, 1], [1, 14, 64, 1, 9, 2, 7, 64, 17], [1, 7, 64, 17, 7, 1, 7, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    656         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 410,369
Trainable params: 410,321
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3ec3dc280ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6311739344385154

Train accuracy: 0.6311739344385154



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 330096
OPT eval latency = 0.000283038
OPT eval accuracy_drop = 0.36882606556148456
OPT eval energy = 0.036109354512
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,165,073
Trainable params: 1,164,977
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3f1533f20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5792624418308361

Train accuracy: 0.5792624418308361



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085184
OPT eval latency = 0.000248238
OPT eval accuracy_drop = 0.4207375581691639
OPT eval energy = 0.0317849238432
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,648,657
Trainable params: 32,648,497
Non-trainable params: 160
__________________________________________________________________________________________________
## ERR: number of trainable params 32648497 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32432000
OPT eval latency = 0.006142242000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7797502512095998
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 3fa4feba0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8041110189790799

Train accuracy: 0.8041110189790799



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.19588898102092012
OPT eval energy = 0.4124193282527999
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 3, 1, 14, 16, 1], [1, 14, 16, 1, 9, 2, 7, 64, 17], [1, 7, 64, 17, 7, 1, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 7, 7, 1088]
rem 1
Added Caps1_layer
[None, 7, 7, 1088]
[None, None, 64]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   4624        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 7, 7, 1088)   1411136     batch_normalization_3[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 7, 7, 1088)   0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 833, 64)      0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2132480     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 3,804,673
Trainable params: 3,803,521
Non-trainable params: 1,152
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4004dbaa0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5693251646013215

Train accuracy: 0.5693251646013215



HW Estimator

5
4
3
2
1
0

Parsed gene

OPT eval memory = 3896184
OPT eval latency = 0.0010535820000000006
OPT eval accuracy_drop = 0.43067483539867846
OPT eval energy = 7.618470578371201
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 3, 1, 14, 16, 1], [1, 14, 16, 1, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 14, 14, 16]
Added Conv3_layer
[None, 14, 14, 16]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 14, 14, 16)   4624        batch_normalization_2[0][0]      
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 14, 14, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 16)      0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        125440      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 386,497
Trainable params: 385,345
Non-trainable params: 1,152
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 406094680ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6265156804595667

Train accuracy: 0.6265156804595667



HW Estimator

4
3
2
1
0

Parsed gene

OPT eval memory = 477368
OPT eval latency = 0.0008510700000000001
OPT eval accuracy_drop = 0.37348431954043326
OPT eval energy = 6.317817821404799
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,767,569
Trainable params: 64,766,513
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64766513 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64349760
OPT eval latency = 0.012066942000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5318838065696008
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,767,569
Trainable params: 64,766,513
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64766513 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64349760
OPT eval latency = 0.012066942000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5318838065696008
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,592,401
Trainable params: 16,592,305
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 413e8c960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7369695612848263

Train accuracy: 0.7369695612848263



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373312
OPT eval latency = 0.003248802000000001
OPT eval accuracy_drop = 0.26303043871517373
OPT eval energy = 0.41252525664959994
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,592,401
Trainable params: 16,592,305
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 41833e360ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6667937701676687

Train accuracy: 0.6667937701676687



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373312
OPT eval latency = 0.003248802000000001
OPT eval accuracy_drop = 0.3332062298323313
OPT eval energy = 0.41252525664959994

Evaluation of current population completed

gen  14
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 16], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,767,569
Trainable params: 64,766,513
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64766513 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64349760
OPT eval latency = 0.012066942000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5318838065696008
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,594,193
Trainable params: 16,594,097
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 42efc5500ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8414909747377678

Train accuracy: 0.8414909747377678



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16375104
OPT eval latency = 0.003249138000000001
OPT eval accuracy_drop = 0.1585090252622322
OPT eval energy = 0.4131745769183999
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 43412b660ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.940679423012635

Train accuracy: 0.940679423012635



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.05932057698736504
OPT eval energy = 0.0548194419168
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,993,361
Trainable params: 128,992,817
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128992817 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128791296
OPT eval latency = 0.02415073800000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0660398610143993
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,993,361
Trainable params: 128,992,817
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128992817 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128791296
OPT eval latency = 0.02415073800000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0660398610143993
### EVAL candidate 8/10
[[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 1,069,124
Trainable params: 1,069,028
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 441f9a400ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7367767123450113

Train accuracy: 0.7367767123450113



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2258280
OPT eval latency = 0.0039538740000000005
OPT eval accuracy_drop = 0.2632232876549887
OPT eval energy = 0.5019395596512001
### EVAL candidate 9/10
[[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,004
Trainable params: 2,103,908
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 446440280ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7487455547445897

Train accuracy: 0.7487455547445897



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 3261840
OPT eval latency = 0.004142034
OPT eval accuracy_drop = 0.2512544452554103
OPT eval energy = 0.5258262458592

Evaluation of current population completed

gen  15
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [0, 14, 32, 1, 3, 1, 14, 16, 1], [1, 14, 16, 1, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 1
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,655,441
Trainable params: 32,654,897
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32654897 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32218176
OPT eval latency = 0.006041694000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7670534561951999
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,595,281
Trainable params: 16,594,993
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4500f29c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8724319245865328

Train accuracy: 0.8724319245865328



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16148288
OPT eval latency = 0.003028590000000001
OPT eval accuracy_drop = 0.12756807541346715
OPT eval energy = 0.384520525968
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 318,353
Trainable params: 318,257
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 454575ac0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.705021108580552

Train accuracy: 0.705021108580552



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 332064
OPT eval latency = 0.00010702200000000002
OPT eval accuracy_drop = 0.294978891419448
OPT eval energy = 0.0138577221024
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 318,353
Trainable params: 318,257
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 45972bf40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7438233401553052

Train accuracy: 0.7438233401553052



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 332064
OPT eval latency = 0.00010702200000000002
OPT eval accuracy_drop = 0.25617665984469484
OPT eval energy = 0.0138577221024
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [0, 14, 16, 32, 3, 1, 14, 32, 1], [1, 14, 32, 1, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 32]
Added Conv2_layer
[None, 14, 14, 32]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 14, 14, 32)   147488      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 14, 14, 32)   128         conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 32)      0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 507,249
Trainable params: 506,129
Non-trainable params: 1,120
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 45ec81800ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6145755721319294

Train accuracy: 0.6145755721319294



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 754984
OPT eval latency = 0.0013252620000000004
OPT eval accuracy_drop = 0.38542442786807063
OPT eval energy = 6.355917031516798
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,122,833
Trainable params: 4,121,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 46312b460ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6874889432236395

Train accuracy: 0.6874889432236395



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4214144
OPT eval latency = 0.000790878
OPT eval accuracy_drop = 0.3125110567763605
OPT eval energy = 0.10245845797439998
### EVAL candidate 6/10
[[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,004
Trainable params: 2,103,908
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4683a3c60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9124989729611496

Train accuracy: 0.9124989729611496



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 3261840
OPT eval latency = 0.004142034
OPT eval accuracy_drop = 0.08750102703885043
OPT eval energy = 0.5258262458592
### EVAL candidate 7/10
[[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,004
Trainable params: 2,103,908
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 46c835ea0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5763858230747572

Train accuracy: 0.5763858230747572



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 3261840
OPT eval latency = 0.004142034
OPT eval accuracy_drop = 0.42361417692524284
OPT eval energy = 0.5258262458592
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,538,753
Trainable params: 1,538,705
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 471905ba0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5793151334480449

Train accuracy: 0.5793151334480449



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1082640
OPT eval latency = 0.000424158
OPT eval accuracy_drop = 0.42068486655195514
OPT eval energy = 0.053846349110399996
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 8]
Added Conv1_layer
[None, 14, 14, 8]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 8)    80          input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 8)    32          conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 196, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 1,538,753
Trainable params: 1,538,705
Non-trainable params: 48
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4767c6e60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7358543694944132

Train accuracy: 0.7358543694944132



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1082640
OPT eval latency = 0.000424158
OPT eval accuracy_drop = 0.2641456305055868
OPT eval energy = 0.053846349110399996

Evaluation of current population completed

gen  16
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 47ac971c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8544166432428841

Train accuracy: 0.8544166432428841



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.14558335675711587
OPT eval energy = 0.0548194419168
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 47fe3b760ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8210914210752512

Train accuracy: 0.8210914210752512



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.17890857892474876
OPT eval energy = 0.0548194419168
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 16], [1, 28, 8, 16, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,764,241
Trainable params: 64,763,953
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64763953 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64552448
OPT eval latency = 0.012105954
OPT eval accuracy_drop = 1
OPT eval energy = 1.5369459928032005
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,649,681
Trainable params: 32,649,521
Non-trainable params: 160
__________________________________________________________________________________________________
## ERR: number of trainable params 32649521 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32433024
OPT eval latency = 0.006142386000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7798675792607999
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 48dca4600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8791295367930614

Train accuracy: 0.8791295367930614



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.12087046320693862
OPT eval energy = 0.0548194419168
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,069,201
Trainable params: 1,069,105
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 492149760ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5025554138746561

Train accuracy: 0.5025554138746561



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1318112
OPT eval latency = 0.00042597
OPT eval accuracy_drop = 0.4974445861253439
OPT eval energy = 0.054170121647999996
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,069,201
Trainable params: 1,069,105
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 497280340ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.803023452771662

Train accuracy: 0.803023452771662



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1318112
OPT eval latency = 0.00042597
OPT eval accuracy_drop = 0.19697654722833802
OPT eval energy = 0.054170121647999996
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,100,561
Trainable params: 8,100,017
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 49c1772a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6539029482736161

Train accuracy: 0.6539029482736161



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8349696
OPT eval latency = 0.0015679379999999998
OPT eval accuracy_drop = 0.34609705172638394
OPT eval energy = 0.19918050037439994
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,167,761
Trainable params: 2,167,601
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4a0624100ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5343693769175465

Train accuracy: 0.5343693769175465



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088384
OPT eval latency = 0.000407022
OPT eval accuracy_drop = 0.4656306230824535
OPT eval energy = 0.05170500202560001
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,166,737
Trainable params: 2,166,577
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4a57edea0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.594761158825744

Train accuracy: 0.594761158825744



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2087360
OPT eval latency = 0.00040687799999999995
OPT eval accuracy_drop = 0.405238841174256
OPT eval energy = 0.05165267384640001

Evaluation of current population completed

gen  17
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [0, 56, 32, 1, 3, 1, 56, 32, 32], [1, 56, 32, 32, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 9, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 1
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 1], [1, 14, 8, 1, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 2, 28, 32, 1], [1, 28, 32, 1, 28, 2, 14, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 16], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 3, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 128]
rem 1
Added Caps1_layer
[None, 56, 56, 128]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 128)  36992       batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 128)  0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 4)    0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 32,248,900
Trainable params: 32,248,804
Non-trainable params: 96
__________________________________________________________________________________________________
## ERR: number of trainable params 32248804 exceeded limit 20000000

Train accuracy: 0



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 32782016
OPT eval latency = 0.006457170000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.1671795027679999
### EVAL candidate 1/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 9, 1, 56, 4, 32], [1, 56, 4, 32, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 128]
rem 1
Added Caps1_layer
[None, 56, 56, 128]
[None, None, 4]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 56, 56, 128)  331904      batch_normalization_1[0][0]      
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 56, 56, 128)  0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 4)    0           lambda_1[0][0]                   
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 32,543,812
Trainable params: 32,543,716
Non-trainable params: 96
__________________________________________________________________________________________________
## ERR: number of trainable params 32543716 exceeded limit 20000000

Train accuracy: 0



HW Estimator

3
2
1
0

Parsed gene

OPT eval memory = 33076928
OPT eval latency = 0.006512466000000001
OPT eval accuracy_drop = 1
OPT eval energy = 4.3205793533664005
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 8,127,428
Trainable params: 8,127,332
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4b3b4d920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7320147734722291

Train accuracy: 0.7320147734722291



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 13048464
OPT eval latency = 0.016568082
OPT eval accuracy_drop = 0.2679852265277709
OPT eval energy = 2.1057145316064
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 16,218,308
Trainable params: 16,218,212
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4b801e540ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7331681008955298

Train accuracy: 0.7331681008955298



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 21076704
OPT eval latency = 0.018073362000000003
OPT eval accuracy_drop = 0.26683189910447025
OPT eval energy = 2.2968080212704005
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,767,569
Trainable params: 64,766,513
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64766513 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64349760
OPT eval latency = 0.012066942000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5318838065696008
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 6/10
[[0, 56, 1, 1, 3, 2, 28, 32, 4], [1, 28, 32, 4, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,468
Trainable params: 8,126,180
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4c5def900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6815631978922227

Train accuracy: 0.6815631978922227



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 9284160
OPT eval latency = 0.00244893
OPT eval accuracy_drop = 0.31843680210777725
OPT eval energy = 0.3108887247840001
### EVAL candidate 7/10
[[0, 56, 1, 1, 3, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 2048]
Added Conv1_layer
[None, 28, 28, 2048]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 2048) 20480       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 128,575,748
Trainable params: 128,571,620
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 128571620 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 129730560
OPT eval latency = 0.024329154000000002
OPT eval accuracy_drop = 1
OPT eval energy = 3.088556905315201
### EVAL candidate 8/10
[[0, 56, 1, 1, 5, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 16,216,516
Trainable params: 16,216,420
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4cf0f0ba0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9035434445478912

Train accuracy: 0.9035434445478912



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 21074912
OPT eval latency = 0.018073026000000002
OPT eval accuracy_drop = 0.09645655545210885
OPT eval energy = 2.2947027038688006
### EVAL candidate 9/10
[[0, 56, 1, 1, 5, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 4,174,276
Trainable params: 4,174,180
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4d41eee80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8739209191747102

Train accuracy: 0.8739209191747102



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 5269472
OPT eval latency = 0.00451845
OPT eval accuracy_drop = 0.12607908082528985
OPT eval energy = 0.573705546672

Evaluation of current population completed

gen  18
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 16], [-1], [2]], 'runid': '0d30a1320ec811ee974b218c4823db5d', 'accuracy_drop': 0.17948892232478242, 'energy': 0.7677513006047999, 'latency': 0.00020723400000000007, 'memory': 392776}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 318,353
Trainable params: 318,257
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4d90fb500ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9042722760850642

Train accuracy: 0.9042722760850642



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 332064
OPT eval latency = 0.00010702200000000002
OPT eval accuracy_drop = 0.09572772391493578
OPT eval energy = 0.0138577221024
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4dd594b80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.850399389403661

Train accuracy: 0.850399389403661



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.149600610596339
OPT eval energy = 0.0548194419168
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,989,265
Trainable params: 128,988,721
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128988721 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128787200
OPT eval latency = 0.024150258000000008
OPT eval accuracy_drop = 1
OPT eval energy = 3.0658462727903992
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,451,601
Trainable params: 257,450,545
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257450545 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257268992
OPT eval latency = 0.048240306
OPT eval accuracy_drop = 1
OPT eval energy = 6.1242275974368
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,451,601
Trainable params: 257,450,545
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257450545 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257268992
OPT eval latency = 0.048240306
OPT eval accuracy_drop = 1
OPT eval energy = 6.1242275974368
### EVAL candidate 6/10
[[0, 56, 1, 1, 3, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 2048]
Added Conv1_layer
[None, 28, 28, 2048]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 2048) 20480       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 128,575,748
Trainable params: 128,571,620
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 128571620 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 129730560
OPT eval latency = 0.024329154000000002
OPT eval accuracy_drop = 1
OPT eval energy = 3.088556905315201
### EVAL candidate 7/10
[[0, 56, 1, 1, 3, 1, 56, 32, 64], [1, 56, 32, 64, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 2048]
Added Conv1_layer
[None, 56, 56, 2048]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 2048) 20480       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 200704, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        513802240   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 513,927,428
Trainable params: 513,923,300
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 513923300 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 518845440
OPT eval latency = 0.09729525000000004
OPT eval accuracy_drop = 1
OPT eval energy = 12.351515233199997
### EVAL candidate 8/10
[[0, 56, 1, 1, 5, 2, 28, 32, 1], [1, 28, 32, 1, 28, 1, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 32)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,516
Trainable params: 2,104,420
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 4fdc57600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8331916322493432

Train accuracy: 0.8331916322493432



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 3262352
OPT eval latency = 0.00414213
OPT eval accuracy_drop = 0.16680836775065677
OPT eval energy = 0.5259321742560001
### EVAL candidate 9/10
[[0, 56, 1, 1, 5, 1, 56, 32, 1], [1, 56, 32, 1, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 32]
Added Conv1_layer
[None, 56, 56, 32]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 8,125,636
Trainable params: 8,125,540
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5021ef1e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8336007291616512

Train accuracy: 0.8336007291616512



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 13046672
OPT eval latency = 0.016567746
OPT eval accuracy_drop = 0.16639927083834882
OPT eval energy = 2.1036092142048

Evaluation of current population completed

gen  19
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 3, 1, 56, 32, 64], [1, 56, 32, 64, 56, 2, 28, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,275,025
Trainable params: 32,274,481
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32274481 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32433920
OPT eval latency = 0.006084017999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7723587842783999
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,275,025
Trainable params: 32,274,481
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32274481 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32433920
OPT eval latency = 0.006084017999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7723587842783999
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,279,121
Trainable params: 32,278,577
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32278577 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32438016
OPT eval latency = 0.006084498
OPT eval accuracy_drop = 1
OPT eval energy = 0.7725523725023998
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,399,441
Trainable params: 64,398,385
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64398385 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64562432
OPT eval latency = 0.012107826
OPT eval accuracy_drop = 1
OPT eval energy = 1.5372526204128005
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 518f77180ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6805798354855941

Train accuracy: 0.6805798354855941



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.3194201645144059
OPT eval energy = 0.1950641942304
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 51e1211c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9283224279940232

Train accuracy: 0.9283224279940232



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.0716775720059768
OPT eval energy = 0.1950641942304
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,993,361
Trainable params: 128,992,817
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128992817 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128791296
OPT eval latency = 0.02415073800000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0660398610143993
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005
### EVAL candidate 8/10
[[0, 56, 1, 1, 5, 1, 56, 32, 64], [1, 56, 32, 64, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 2048]
Added Conv1_layer
[None, 56, 56, 2048]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 2048) 53248       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 200704, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        513802240   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 513,960,196
Trainable params: 513,956,068
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 513956068 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 518878208
OPT eval latency = 0.09729909000000003
OPT eval accuracy_drop = 1
OPT eval energy = 12.352717273007997
### EVAL candidate 9/10
[[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 1024]
Added Conv1_layer
[None, 56, 56, 1024]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 257,028,356
Trainable params: 257,026,276
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 257026276 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 261947904
OPT eval latency = 0.049124657999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.236846994710398

Evaluation of current population completed

gen  20
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 2, 28, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 2, 28, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,188,881
Trainable params: 8,188,721
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 534e8fda0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5411575274847968

Train accuracy: 0.5411575274847968



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344704
OPT eval latency = 0.0016258259999999997
OPT eval accuracy_drop = 0.45884247251520316
OPT eval energy = 0.20649570713280002
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,112,081
Trainable params: 4,111,921
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 539d944a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8333558512328529

Train accuracy: 0.8333558512328529



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4329984
OPT eval latency = 0.0008730900000000002
OPT eval accuracy_drop = 0.16664414876714706
OPT eval energy = 0.11093677521600004
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,594,193
Trainable params: 16,594,097
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 53e243d80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5102354843892409

Train accuracy: 0.5102354843892409



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16375104
OPT eval latency = 0.003249138000000001
OPT eval accuracy_drop = 0.48976451561075907
OPT eval energy = 0.4131745769183999
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 543456640ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5442086569077228

Train accuracy: 0.5442086569077228



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.4557913430922772
OPT eval energy = 0.4124193282527999
### EVAL candidate 4/10
[[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 1, 56, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 1024]
Added Conv1_layer
[None, 56, 56, 1024]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 257,028,356
Trainable params: 257,026,276
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 257026276 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 261947904
OPT eval latency = 0.049124657999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.236846994710398
### EVAL candidate 5/10
[[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 1024]
Added Conv1_layer
[None, 56, 56, 1024]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 257,028,356
Trainable params: 257,026,276
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 257026276 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 261947904
OPT eval latency = 0.049124657999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.236846994710398
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 551267b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6434365092973221

Train accuracy: 0.6434365092973221



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.3565634907026779
OPT eval energy = 0.3874534360224
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 555716300ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6834731733990876

Train accuracy: 0.6834731733990876



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.31652682660091236
OPT eval energy = 0.3874534360224
### EVAL candidate 8/10
[[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 512]
Added Conv1_layer
[None, 56, 56, 512]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 128,562,436
Trainable params: 128,561,380
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128561380 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 133482752
OPT eval latency = 0.02503744200000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.1789118555616005
### EVAL candidate 9/10
[[0, 56, 1, 1, 5, 1, 56, 32, 8], [1, 56, 32, 8, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 256]
Added Conv1_layer
[None, 56, 56, 256]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 64,329,476
Trainable params: 64,328,932
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64328932 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69250176
OPT eval latency = 0.013934657999999999
OPT eval accuracy_drop = 1
OPT eval energy = 1.7693807637984003

Evaluation of current population completed

gen  21
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 8], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 600,593
Trainable params: 600,497
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 563785120ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.752222168147878

Train accuracy: 0.752222168147878



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 583104
OPT eval latency = 0.00015411
OPT eval accuracy_drop = 0.247777831852122
OPT eval energy = 0.0198354871968
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 600,593
Trainable params: 600,497
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5686412a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6381835887223938

Train accuracy: 0.6381835887223938



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 583104
OPT eval latency = 0.00015411
OPT eval accuracy_drop = 0.3618164112776062
OPT eval energy = 0.0198354871968
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,279,121
Trainable params: 32,278,577
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32278577 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32438016
OPT eval latency = 0.006084498
OPT eval accuracy_drop = 1
OPT eval energy = 0.7725523725023998
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,100,561
Trainable params: 8,100,017
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5718ed4a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5180673879121165

Train accuracy: 0.5180673879121165



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8349696
OPT eval latency = 0.0015679379999999998
OPT eval accuracy_drop = 0.4819326120878835
OPT eval energy = 0.19918050037439994
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,252,753
Trainable params: 32,251,697
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32251697 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32473344
OPT eval latency = 0.006091121999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7757470726367999
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,111,057
Trainable params: 4,110,897
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 57f786720ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8003164433918457

Train accuracy: 0.8003164433918457



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328960
OPT eval latency = 0.0008729460000000002
OPT eval accuracy_drop = 0.1996835566081543
OPT eval energy = 0.11081944716480004
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,111,057
Trainable params: 4,110,897
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 583c2d5e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6320219957604672

Train accuracy: 0.6320219957604672



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328960
OPT eval latency = 0.0008729460000000002
OPT eval accuracy_drop = 0.36797800423953275
OPT eval energy = 0.11081944716480004
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,451,601
Trainable params: 257,450,545
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257450545 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257268992
OPT eval latency = 0.048240306
OPT eval accuracy_drop = 1
OPT eval energy = 6.1242275974368
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,775,761
Trainable params: 64,774,705
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64774705 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64357952
OPT eval latency = 0.012067902000000004
OPT eval accuracy_drop = 1
OPT eval energy = 1.5321193166496008

Evaluation of current population completed

gen  22
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,100,561
Trainable params: 8,100,017
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 591adf5e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8351650821631924

Train accuracy: 0.8351650821631924



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8349696
OPT eval latency = 0.0015679379999999998
OPT eval accuracy_drop = 0.1648349178368076
OPT eval energy = 0.19918050037439994
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,114,897
Trainable params: 8,114,353
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 596d2fa20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7903322444912253

Train accuracy: 0.7903322444912253



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8364032
OPT eval latency = 0.0015706259999999997
OPT eval accuracy_drop = 0.2096677555087747
OPT eval energy = 0.20091830742719993
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 59b1ffc40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6013170929885019

Train accuracy: 0.6013170929885019



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.3986829070114981
OPT eval energy = 0.1950641942304
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5a0331b40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6184778871281296

Train accuracy: 0.6184778871281296



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.38152211287187043
OPT eval energy = 0.1950641942304
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5a5212480ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7446470616777249

Train accuracy: 0.7446470616777249



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.2553529383222751
OPT eval energy = 0.1950641942304
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,651,345
Trainable params: 32,650,801
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32650801 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32214080
OPT eval latency = 0.006041214000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7669248678431999
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,655,441
Trainable params: 32,654,897
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32654897 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32218176
OPT eval latency = 0.006041694000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7670534561951999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,651,345
Trainable params: 32,650,801
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32650801 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32214080
OPT eval latency = 0.006041214000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7669248678431999
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,094,161
Trainable params: 4,093,105
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5b719ee60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.927068093343618

Train accuracy: 0.927068093343618



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4185472
OPT eval latency = 0.000785502
OPT eval accuracy_drop = 0.07293190665638205
OPT eval energy = 0.09983217552959997
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,094,161
Trainable params: 4,093,105
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5bc3a0d80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8869921036811907

Train accuracy: 0.8869921036811907



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4185472
OPT eval latency = 0.000785502
OPT eval accuracy_drop = 0.11300789631880925
OPT eval energy = 0.09983217552959997

Evaluation of current population completed

gen  23
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 1, 56, 32, 8], [1, 56, 32, 8, 56, 2, 28, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 8], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5c087f1e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.740662464094176

Train accuracy: 0.740662464094176



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.259337535905824
OPT eval energy = 0.4124193282527999
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,592,401
Trainable params: 16,592,305
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5c599fe80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7917541461794465

Train accuracy: 0.7917541461794465



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373312
OPT eval latency = 0.003248802000000001
OPT eval accuracy_drop = 0.2082458538205535
OPT eval energy = 0.41252525664959994
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,094,161
Trainable params: 4,093,105
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5ca89d140ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5403716747536553

Train accuracy: 0.5403716747536553



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4185472
OPT eval latency = 0.000785502
OPT eval accuracy_drop = 0.45962832524634467
OPT eval energy = 0.09983217552959997
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5ced50440ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5805719988164354

Train accuracy: 0.5805719988164354



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1163968
OPT eval latency = 0.000248286
OPT eval accuracy_drop = 0.4194280011835646
OPT eval energy = 0.0315642695328
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5d3f14420ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6896586509184168

Train accuracy: 0.6896586509184168



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.3103413490815832
OPT eval energy = 0.1950641942304
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5d8e24b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6455283011991918

Train accuracy: 0.6455283011991918



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.3544716988008082
OPT eval energy = 0.10316138775360001
### EVAL candidate 6/10
[[0, 56, 1, 1, 5, 2, 28, 32, 8], [1, 28, 32, 8, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 16,160,516
Trainable params: 16,159,972
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5dd2effa0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7248302501416515

Train accuracy: 0.7248302501416515



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 17318016
OPT eval latency = 0.0034847220000000004
OPT eval accuracy_drop = 0.2751697498583485
OPT eval energy = 0.44251392903360004
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 2, 28, 32, 8], [1, 28, 32, 8, 28, 2, 14, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 16,174,852
Trainable params: 16,174,308
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5e24f0660ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8108510203838863

Train accuracy: 0.8108510203838863



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 17332352
OPT eval latency = 0.0034874100000000007
OPT eval accuracy_drop = 0.18914897961611365
OPT eval energy = 0.4442517360864
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,252,753
Trainable params: 32,251,697
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32251697 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32473344
OPT eval latency = 0.006091121999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7757470726367999
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,252,753
Trainable params: 32,251,697
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32251697 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32473344
OPT eval latency = 0.006091121999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7757470726367999

Evaluation of current population completed

gen  24
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5f02e3c60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5934143040257873

Train accuracy: 0.5934143040257873



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.4065856959742127
OPT eval energy = 0.10324260878400002
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5f4797280ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6668057341978909

Train accuracy: 0.6668057341978909



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.3331942658021091
OPT eval energy = 0.10324260878400002
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5f996d960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9074486432473851

Train accuracy: 0.9074486432473851



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.09255135675261494
OPT eval energy = 0.10324260878400002
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,174,673
Trainable params: 4,174,385
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 5fde21020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5954244199845186

Train accuracy: 0.5954244199845186



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4173440
OPT eval latency = 0.0008126700000000003
OPT eval accuracy_drop = 0.40457558001548144
OPT eval energy = 0.10316748129600002
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 602d416a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5516823427838985

Train accuracy: 0.5516823427838985



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.4483176572161015
OPT eval energy = 0.10324260878400002
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 607f3cf40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5274298183773675

Train accuracy: 0.5274298183773675



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.47257018162263253
OPT eval energy = 0.10324260878400002
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 2, 14, 16, 16], [1, 14, 16, 16, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,194,641
Trainable params: 8,194,097
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 60c3e0660ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6207596813540587

Train accuracy: 0.6207596813540587



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8194176
OPT eval latency = 0.0015371340000000008
OPT eval accuracy_drop = 0.3792403186459413
OPT eval energy = 0.1952049696672
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 611508600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5507071408743616

Train accuracy: 0.5507071408743616



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.44929285912563843
OPT eval energy = 0.10324260878400002
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,550,161
Trainable params: 4,550,065
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6163f6960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5851609604495593

Train accuracy: 0.5851609604495593



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095872
OPT eval latency = 0.0008127180000000003
OPT eval accuracy_drop = 0.41483903955044066
OPT eval energy = 0.10320231627840001
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 61a8b1fa0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5114995085517459

Train accuracy: 0.5114995085517459



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.48850049144825414
OPT eval energy = 0.10316138775360001

Evaluation of current population completed

gen  25
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 64], [1, 14, 16, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 16, 64], [1, 14, 16, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 1024]
Added Conv1_layer
[None, 14, 14, 1024]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,302,161
Trainable params: 32,300,081
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 32300081 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32306304
OPT eval latency = 0.006058158000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7692815001504001
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 16, 64], [1, 14, 16, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 1024]
Added Conv1_layer
[None, 14, 14, 1024]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,302,161
Trainable params: 32,300,081
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 32300081 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32306304
OPT eval latency = 0.006058158000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7692815001504001
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,651,345
Trainable params: 32,650,801
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32650801 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32214080
OPT eval latency = 0.006041214000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7669248678431999
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,651,345
Trainable params: 32,650,801
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32650801 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32214080
OPT eval latency = 0.006041214000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7669248678431999
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 631753f20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8485897775055762

Train accuracy: 0.8485897775055762



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.15141022249442382
OPT eval energy = 0.1950641942304
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 636894ce0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8586847247577021

Train accuracy: 0.8586847247577021



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.14131527524229792
OPT eval energy = 0.1950641942304
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 2, 14, 16, 64], [1, 14, 16, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 1024]
Added Conv1_layer
[None, 14, 14, 1024]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,302,161
Trainable params: 32,300,081
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 32300081 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32306304
OPT eval latency = 0.006058158000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7692815001504001
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,230,481
Trainable params: 16,229,425
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 63f925c00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6165342946164191

Train accuracy: 0.6165342946164191



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16231552
OPT eval latency = 0.0030441419999999997
OPT eval accuracy_drop = 0.38346570538358093
OPT eval energy = 0.3865638131616001
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 644b05200ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6657526343515296

Train accuracy: 0.6657526343515296



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.33424736564847035
OPT eval energy = 0.10316138775360001
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 648fab940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6598907402252758

Train accuracy: 0.6598907402252758



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.34010925977472417
OPT eval energy = 0.10316138775360001

Evaluation of current population completed

gen  26
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 8], [1, 28, 32, 8, 28, 2, 14, 10, 8], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,139,601
Trainable params: 8,138,545
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 64e127c60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5296708784081592

Train accuracy: 0.5296708784081592



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8200832
OPT eval latency = 0.0015383820000000007
OPT eval accuracy_drop = 0.4703291215918408
OPT eval energy = 0.19540938807359998
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,139,601
Trainable params: 8,138,545
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6530176e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6921099182667316

Train accuracy: 0.6921099182667316



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8200832
OPT eval latency = 0.0015383820000000007
OPT eval accuracy_drop = 0.3078900817332684
OPT eval energy = 0.19540938807359998
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,094,161
Trainable params: 4,093,105
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6574dc960ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5772748623470733

Train accuracy: 0.5772748623470733



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4185472
OPT eval latency = 0.000785502
OPT eval accuracy_drop = 0.42272513765292674
OPT eval energy = 0.09983217552959997
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 16,136,401
Trainable params: 16,135,345
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 65c670f60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.787826499588597

Train accuracy: 0.787826499588597



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16698112
OPT eval latency = 0.003133266000000001
OPT eval accuracy_drop = 0.21217350041140304
OPT eval energy = 0.39794299788480003
### EVAL candidate 4/10
[[0, 56, 1, 1, 9, 1, 56, 32, 8], [1, 56, 32, 8, 56, 2, 28, 10, 8], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 256]
Added Conv1_layer
[None, 56, 56, 256]
[None, None, 32]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 96,516
Trainable params: 96,484
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    96516       mask_1[0][0]                     
==================================================================================================
Total params: 64,343,812
Trainable params: 64,343,268
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64343268 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69264512
OPT eval latency = 0.013937346
OPT eval accuracy_drop = 1
OPT eval energy = 1.7725745679840004
### EVAL candidate 5/10
[[0, 56, 1, 1, 9, 1, 56, 32, 8], [1, 56, 32, 8, 56, 2, 28, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 256]
Added Conv1_layer
[None, 56, 56, 256]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 128,631,812
Trainable params: 128,631,268
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128631268 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 133490432
OPT eval latency = 0.025979682000000007
OPT eval accuracy_drop = 1
OPT eval energy = 3.3013346723807993
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,648,657
Trainable params: 32,648,497
Non-trainable params: 160
__________________________________________________________________________________________________
## ERR: number of trainable params 32648497 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32432000
OPT eval latency = 0.006142242000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7797502512095998
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 66e6704e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5292419803183231

Train accuracy: 0.5292419803183231



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.47075801968167685
OPT eval energy = 0.1950641942304
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6737a0040ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8273546223629734

Train accuracy: 0.8273546223629734



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.1726453776370266
OPT eval energy = 0.1950641942304
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 4,299,217
Trainable params: 4,299,057
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6786ade80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7389522992465047

Train accuracy: 0.7389522992465047



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095680
OPT eval latency = 0.000783438
OPT eval accuracy_drop = 0.26104770075349526
OPT eval energy = 0.09945651397439997

Evaluation of current population completed

gen  27
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 1, 56, 32, 8], [1, 56, 32, 8, 56, 2, 28, 10, 16], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,114,897
Trainable params: 8,114,353
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 67cbae0c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5912270907326954

Train accuracy: 0.5912270907326954



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8364032
OPT eval latency = 0.0015706259999999997
OPT eval accuracy_drop = 0.4087729092673046
OPT eval energy = 0.20091830742719993
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 681d7a200ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8695143780367451

Train accuracy: 0.8695143780367451



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.13048562196325486
OPT eval energy = 0.05136966204480002
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 686ce31c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6315357636212288

Train accuracy: 0.6315357636212288



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.36846423637877124
OPT eval energy = 0.10316138775360001
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 68b1e4e40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8033522051046025

Train accuracy: 0.8033522051046025



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.19664779489539752
OPT eval energy = 0.10316138775360001
### EVAL candidate 4/10
[[0, 56, 1, 1, 9, 1, 56, 32, 8], [1, 56, 32, 8, 56, 1, 56, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 256]
Added Conv1_layer
[None, 56, 56, 256]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 128,631,812
Trainable params: 128,631,268
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128631268 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 133490432
OPT eval latency = 0.025979682000000007
OPT eval accuracy_drop = 1
OPT eval energy = 3.3013346723807993
### EVAL candidate 5/10
[[0, 56, 1, 1, 9, 2, 28, 32, 8], [1, 28, 32, 8, 28, 1, 28, 10, 16], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 32]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 159,236
Trainable params: 159,204
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    159236      mask_1[0][0]                     
==================================================================================================
Total params: 32,293,892
Trainable params: 32,293,348
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32293348 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 33389312
OPT eval latency = 0.006498066000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.8264509024992
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,313,361
Trainable params: 8,313,265
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 699381920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5709018666708395

Train accuracy: 0.5709018666708395



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8343872
OPT eval latency = 0.0017432820000000005
OPT eval accuracy_drop = 0.42909813332916047
OPT eval energy = 0.22140129927360006
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,252,753
Trainable params: 32,251,697
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32251697 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32473344
OPT eval latency = 0.006091121999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7757470726367999
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,105,873
Trainable params: 2,105,777
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6a7212180ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9329329290409256

Train accuracy: 0.9329329290409256



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2323584
OPT eval latency = 0.000614514
OPT eval accuracy_drop = 0.06706707095907438
OPT eval energy = 0.0787122216672

Evaluation of current population completed

gen  28
{'gene': [[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 1, 28, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 16]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 16,136,401
Trainable params: 16,135,345
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6ab6f8060ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8741634739862834

Train accuracy: 0.8741634739862834



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16698112
OPT eval latency = 0.003133266000000001
OPT eval accuracy_drop = 0.12583652601371664
OPT eval energy = 0.39794299788480003
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,399,441
Trainable params: 64,398,385
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64398385 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64870912
OPT eval latency = 0.012165665999999999
OPT eval accuracy_drop = 1
OPT eval energy = 1.5445953390047997
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,081
Trainable params: 2,103,985
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6b53aebc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7100711742155287

Train accuracy: 0.7100711742155287



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2321792
OPT eval latency = 0.000614178
OPT eval accuracy_drop = 0.2899288257844713
OPT eval energy = 0.0780629013984
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,081
Trainable params: 2,103,985
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6b9897480ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8294970247899218

Train accuracy: 0.8294970247899218



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2321792
OPT eval latency = 0.000614178
OPT eval accuracy_drop = 0.17050297521007818
OPT eval energy = 0.0780629013984
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6bea740a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7769246458504955

Train accuracy: 0.7769246458504955



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.22307535414950452
OPT eval energy = 0.05136966204480002
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6c39a2140ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.777179012700093

Train accuracy: 0.777179012700093



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.22282098729990696
OPT eval energy = 0.05136966204480002
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 1, 28, 16, 32], [1, 28, 16, 32, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,399,441
Trainable params: 64,398,385
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64398385 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64870912
OPT eval latency = 0.012165665999999999
OPT eval accuracy_drop = 1
OPT eval energy = 1.5445953390047997
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,230,481
Trainable params: 16,229,425
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6ccd9cbc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6302942527364703

Train accuracy: 0.6302942527364703



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16231552
OPT eval latency = 0.0030441419999999997
OPT eval accuracy_drop = 0.36970574726352967
OPT eval energy = 0.3865638131616001
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005

Evaluation of current population completed

gen  29
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 8], [1, 28, 32, 8, 28, 1, 28, 10, 16], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 64], [1, 28, 32, 64, 28, 1, 28, 10, 4], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,114,897
Trainable params: 8,114,353
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6dac5a420ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7077704987613237

Train accuracy: 0.7077704987613237



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8364032
OPT eval latency = 0.0015706259999999997
OPT eval accuracy_drop = 0.2922295012386763
OPT eval energy = 0.20091830742719993
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6df15e760ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8742772615810376

Train accuracy: 0.8742772615810376



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.12572273841896242
OPT eval energy = 0.05136966204480002
### EVAL candidate 2/10
[[0, 56, 1, 1, 9, 2, 28, 32, 8], [1, 28, 32, 8, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 8,115,332
Trainable params: 8,114,788
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6e43a35c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6285787764827884

Train accuracy: 0.6285787764827884



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 9303872
OPT eval latency = 0.0019820820000000005
OPT eval accuracy_drop = 0.37142122351721163
OPT eval energy = 0.25315215288000004
### EVAL candidate 3/10
[[0, 56, 1, 1, 9, 2, 28, 32, 64], [1, 28, 32, 64, 28, 1, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 2048]
Added Conv1_layer
[None, 28, 28, 2048]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 2048) 167936      input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,466,564
Trainable params: 64,462,436
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 64462436 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 65650176
OPT eval latency = 0.012311778000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5711952226783998
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6ed708fe0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6409330735624599

Train accuracy: 0.6409330735624599



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.3590669264375401
OPT eval energy = 0.05136966204480002
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 6f2625600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8513694040396529

Train accuracy: 0.8513694040396529



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.1486305959603471
OPT eval energy = 0.05136966204480002
### EVAL candidate 6/10
[[0, 56, 1, 1, 9, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 2048]
Added Conv1_layer
[None, 28, 28, 2048]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 2048) 167936      input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,466,564
Trainable params: 64,462,436
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 64462436 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 65650176
OPT eval latency = 0.012311778000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5711952226783998
### EVAL candidate 7/10
[[0, 56, 1, 1, 9, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 2048]
Added Conv1_layer
[None, 28, 28, 2048]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 2048) 167936      input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 2048) 8192        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,466,564
Trainable params: 64,462,436
Non-trainable params: 4,128
__________________________________________________________________________________________________
## ERR: number of trainable params 64462436 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 65650176
OPT eval latency = 0.012311778000000002
OPT eval accuracy_drop = 1
OPT eval energy = 1.5711952226783998
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 70057f6c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6766140647170281

Train accuracy: 0.6766140647170281



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16260224
OPT eval latency = 0.0030495179999999998
OPT eval accuracy_drop = 0.3233859352829719
OPT eval energy = 0.3891900956064001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,804,433
Trainable params: 64,803,377
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64803377 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64444544
OPT eval latency = 0.012084077999999998
OPT eval accuracy_drop = 1
OPT eval energy = 1.5361166461344002

Evaluation of current population completed

gen  30
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '1876dd720ec811ee974b218c4823db5d', 'accuracy_drop': 0.06446232294491305, 'energy': 0.21077717833919998, 'latency': 0.0015634740000000007, 'memory': 8133428}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 64], [1, 28, 32, 64, 28, 2, 14, 10, 4], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,651,345
Trainable params: 32,650,801
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32650801 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32214080
OPT eval latency = 0.006041214000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7669248678431999
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,344,145
Trainable params: 16,343,601
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 70dc046a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6206554148492872

Train accuracy: 0.6206554148492872



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16147520
OPT eval latency = 0.0030287340000000012
OPT eval accuracy_drop = 0.3793445851507128
OPT eval energy = 0.3844941468192
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 712d53d80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5768980611807468

Train accuracy: 0.5768980611807468



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.4231019388192532
OPT eval energy = 0.4124193282527999
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,103,569
Trainable params: 2,103,473
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 717ca9e20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6415603258168898

Train accuracy: 0.6415603258168898



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2321280
OPT eval latency = 0.000614082
OPT eval accuracy_drop = 0.3584396741831102
OPT eval energy = 0.0779569730016
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,517,201
Trainable params: 64,516,657
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64516657 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64555776
OPT eval latency = 0.012106578
OPT eval accuracy_drop = 1
OPT eval energy = 1.5370482020064005
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,513,105
Trainable params: 64,512,561
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64512561 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64551680
OPT eval latency = 0.012106098000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.5368546137824004
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,531,537
Trainable params: 64,530,993
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64530993 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64570112
OPT eval latency = 0.012109266
OPT eval accuracy_drop = 1
OPT eval energy = 1.5387860090592005
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 64,531,537
Trainable params: 64,530,993
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 64530993 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64570112
OPT eval latency = 0.012109266
OPT eval accuracy_drop = 1
OPT eval energy = 1.5387860090592005
### EVAL candidate 8/10
[[0, 56, 1, 1, 9, 2, 28, 32, 4], [1, 28, 32, 4, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 32)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 4,090,244
Trainable params: 4,089,956
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 72eaee4c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6721324272581942

Train accuracy: 0.6721324272581942



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 5279136
OPT eval latency = 0.0016978260000000006
OPT eval accuracy_drop = 0.3278675727418058
OPT eval energy = 0.2165875834848
### EVAL candidate 9/10
[[0, 56, 1, 1, 9, 2, 28, 32, 16], [1, 28, 32, 16, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 16,165,508
Trainable params: 16,164,452
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 732fdec60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8599074545815917

Train accuracy: 0.8599074545815917



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 17353344
OPT eval latency = 0.003256146000000001
OPT eval accuracy_drop = 0.14009254541840832
OPT eval energy = 0.41585027140799996

Evaluation of current population completed

gen  31
{'gene': [[0, 56, 1, 1, 9, 2, 28, 32, 16], [1, 28, 32, 16, 28, 2, 14, 10, 4], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 8], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 32], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 56, 1, 1, 9, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 512]
Added Conv1_layer
[None, 56, 56, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,334,468
Trainable params: 64,333,412
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64333412 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69285504
OPT eval latency = 0.013000482
OPT eval accuracy_drop = 1
OPT eval energy = 1.6545980300256
### EVAL candidate 1/10
[[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 512]
Added Conv1_layer
[None, 56, 56, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,305,796
Trainable params: 64,304,740
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64304740 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69256832
OPT eval latency = 0.012995106000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.6501517511648
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,081
Trainable params: 2,103,985
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 74116ada0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6838488786884303

Train accuracy: 0.6838488786884303



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2321792
OPT eval latency = 0.000614178
OPT eval accuracy_drop = 0.31615112131156975
OPT eval energy = 0.0780629013984
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 598,801
Trainable params: 598,705
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7460786e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7530318588384517

Train accuracy: 0.7530318588384517



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 581312
OPT eval latency = 0.00015377400000000002
OPT eval accuracy_drop = 0.2469681411615483
OPT eval energy = 0.0195501662112
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,114,897
Trainable params: 8,114,353
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 74a57d4c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6404293452787408

Train accuracy: 0.6404293452787408



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8364032
OPT eval latency = 0.0015706259999999997
OPT eval accuracy_drop = 0.35957065472125915
OPT eval energy = 0.20091830742719993
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 8,114,897
Trainable params: 8,114,353
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 74f720520ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.700728786339313

Train accuracy: 0.700728786339313



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8364032
OPT eval latency = 0.0015706259999999997
OPT eval accuracy_drop = 0.299271213660687
OPT eval energy = 0.20091830742719993
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 16,155,985
Trainable params: 16,155,441
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 75465c620ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7074059517268081

Train accuracy: 0.7074059517268081



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16375040
OPT eval latency = 0.0030729780000000014
OPT eval accuracy_drop = 0.2925940482731919
OPT eval energy = 0.3901108695264001
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 16,155,985
Trainable params: 16,155,441
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 758b53a80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7351221543949498

Train accuracy: 0.7351221543949498



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16375040
OPT eval latency = 0.0030729780000000014
OPT eval accuracy_drop = 0.26487784560505023
OPT eval energy = 0.3901108695264001
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,362,577
Trainable params: 16,362,033
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 75dd694a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7906111251392012

Train accuracy: 0.7906111251392012



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16165952
OPT eval latency = 0.0030319020000000012
OPT eval accuracy_drop = 0.20938887486079882
OPT eval energy = 0.3859965429408
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,132,177
Trainable params: 4,131,633
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 762260f40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8295744007999946

Train accuracy: 0.8295744007999946



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4116032
OPT eval latency = 0.0007725419999999999
OPT eval accuracy_drop = 0.17042559920000544
OPT eval energy = 0.09917350217279998

Evaluation of current population completed

gen  32
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 32], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 8], [-1], [1]], 'runid': '28e1d02c0ec811ee974b218c4823db5d', 'accuracy_drop': 0.3658442783401695, 'energy': 0.008166377424, 'latency': 5.5302000000000014e-05, 'memory': 137340}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,989,265
Trainable params: 128,988,721
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128988721 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128787200
OPT eval latency = 0.024150258000000008
OPT eval accuracy_drop = 1
OPT eval energy = 3.0658462727903992
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,989,265
Trainable params: 128,988,721
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128988721 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128787200
OPT eval latency = 0.024150258000000008
OPT eval accuracy_drop = 1
OPT eval energy = 3.0658462727903992
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,341,457
Trainable params: 16,341,297
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 770290a20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9364597415705249

Train accuracy: 0.9364597415705249



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373120
OPT eval latency = 0.0031312020000000013
OPT eval accuracy_drop = 0.06354025842947508
OPT eval energy = 0.3975023364576
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,741,969
Trainable params: 128,740,913
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128740913 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128789760
OPT eval latency = 0.02415102600000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.065943769468799
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 128,993,361
Trainable params: 128,992,817
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 128992817 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 128791296
OPT eval latency = 0.02415073800000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.0660398610143993
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  6656        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,655,441
Trainable params: 32,654,897
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32654897 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32218176
OPT eval latency = 0.006041694000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7670534561951999
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 1,100,497
Trainable params: 1,100,337
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 782ff9600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5369427239441339

Train accuracy: 0.5369427239441339



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083200
OPT eval latency = 0.00021862200000000008
OPT eval accuracy_drop = 0.4630572760558661
OPT eval energy = 0.027753800553600008
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,166,737
Trainable params: 2,166,577
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7874cdf60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5836914286657743

Train accuracy: 0.5836914286657743



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2087360
OPT eval latency = 0.00040687799999999995
OPT eval accuracy_drop = 0.4163085713342257
OPT eval energy = 0.05165267384640001
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32321664
OPT eval latency = 0.006061038000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7714989457824001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32321664
OPT eval latency = 0.006061038000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7714989457824001

Evaluation of current population completed

gen  33
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 1, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32321664
OPT eval latency = 0.006061038000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7714989457824001
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 16, 32], [1, 14, 16, 32, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32321664
OPT eval latency = 0.006061038000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7714989457824001
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 16, 32], [1, 28, 16, 32, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 16)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 128,778,833
Trainable params: 128,777,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 128777777 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 129129984
OPT eval latency = 0.024214242000000007
OPT eval accuracy_drop = 1
OPT eval energy = 3.0764554088928
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 16, 8], [1, 28, 16, 8, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,407,889
Trainable params: 32,407,601
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32407601 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32752896
OPT eval latency = 0.006261138000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7958945659104003
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,294,033
Trainable params: 2,293,937
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7a7cc1da0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.867018687831966

Train accuracy: 0.867018687831966



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2089344
OPT eval latency = 0.00043649399999999994
OPT eval accuracy_drop = 0.132981312168034
OPT eval energy = 0.055683797136000024
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,294,033
Trainable params: 2,293,937
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7ac1b7b80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5640436920637105

Train accuracy: 0.5640436920637105



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2089344
OPT eval latency = 0.00043649399999999994
OPT eval accuracy_drop = 0.4359563079362895
OPT eval energy = 0.055683797136000024
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,775,761
Trainable params: 64,774,705
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64774705 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64357952
OPT eval latency = 0.012067902000000004
OPT eval accuracy_drop = 1
OPT eval energy = 1.5321193166496008
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,775,761
Trainable params: 64,774,705
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64774705 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64357952
OPT eval latency = 0.012067902000000004
OPT eval accuracy_drop = 1
OPT eval energy = 1.5321193166496008
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,595,281
Trainable params: 16,594,993
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7ba317620ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5270359325721997

Train accuracy: 0.5270359325721997



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16148288
OPT eval latency = 0.003028590000000001
OPT eval accuracy_drop = 0.4729640674278003
OPT eval energy = 0.384520525968
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,595,281
Trainable params: 16,594,993
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7bf240940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7437258208199289

Train accuracy: 0.7437258208199289



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16148288
OPT eval latency = 0.003028590000000001
OPT eval accuracy_drop = 0.2562741791800711
OPT eval energy = 0.384520525968

Evaluation of current population completed

gen  34
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '770290a20ec811ee974b218c4823db5d', 'accuracy_drop': 0.06354025842947508, 'energy': 0.3975023364576, 'latency': 0.0031312020000000013, 'memory': 16373120}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]], 'runid': '176e80420ec811ee974b218c4823db5d', 'accuracy_drop': 0.10538052724331437, 'energy': 0.8032776631775999, 'latency': 0.00024726600000000016, 'memory': 589456}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,595,281
Trainable params: 16,594,993
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7c375f620ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.946129054780458

Train accuracy: 0.946129054780458



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16148288
OPT eval latency = 0.003028590000000001
OPT eval accuracy_drop = 0.053870945219542055
OPT eval energy = 0.384520525968
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,106,961
Trainable params: 2,106,673
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7c8941380ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.567785163583178

Train accuracy: 0.567785163583178



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2090048
OPT eval latency = 0.00039267000000000013
OPT eval accuracy_drop = 0.432214836416822
OPT eval energy = 0.049893645072000024
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,341,457
Trainable params: 16,341,297
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7cd879b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7472386008026302

Train accuracy: 0.7472386008026302



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373120
OPT eval latency = 0.0031312020000000013
OPT eval accuracy_drop = 0.25276139919736984
OPT eval energy = 0.3975023364576
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 16,341,457
Trainable params: 16,341,297
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7d1d662e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7314830882006176

Train accuracy: 0.7314830882006176



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373120
OPT eval latency = 0.0031312020000000013
OPT eval accuracy_drop = 0.2685169117993824
OPT eval energy = 0.3975023364576
### EVAL candidate 4/10
[[0, 56, 1, 1, 5, 2, 28, 32, 16], [1, 28, 32, 16, 28, 2, 14, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 16,136,836
Trainable params: 16,135,780
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7d6f93360ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7466524567742818

Train accuracy: 0.7466524567742818



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 17324672
OPT eval latency = 0.003250770000000001
OPT eval accuracy_drop = 0.2533475432257182
OPT eval energy = 0.41285998967999993
### EVAL candidate 5/10
[[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 512]
Added Conv1_layer
[None, 56, 56, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,305,796
Trainable params: 64,304,740
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64304740 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69256832
OPT eval latency = 0.012995106000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.6501517511648
### EVAL candidate 6/10
[[0, 56, 1, 1, 5, 1, 56, 32, 16], [1, 56, 32, 16, 56, 2, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 512]
Added Conv1_layer
[None, 56, 56, 512]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 32)    0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 64,305,796
Trainable params: 64,304,740
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64304740 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 69256832
OPT eval latency = 0.012995106000000001
OPT eval accuracy_drop = 1
OPT eval energy = 1.6501517511648
### EVAL candidate 7/10
[[0, 56, 1, 1, 5, 1, 56, 32, 32], [1, 56, 32, 32, 56, 2, 28, 10, 4], [-1], [2]]

Wrapping...

Number of devices: 1
x_train shape: (56, 56, 1)
### Input shape
xtra_skip is -1

[None, 56, 56, 1024]
Added Conv1_layer
[None, 56, 56, 1024]
[None, None, 32]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 4)         580       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 4)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 56, 56, 1)         0         
=================================================================
Total params: 65,156
Trainable params: 65,124
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 56, 56, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 56, 56, 1024) 26624       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 56, 56, 1024) 4096        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 100352, 32)   0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        128450560   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 56, 56, 1)    65156       mask_1[0][0]                     
==================================================================================================
Total params: 128,546,436
Trainable params: 128,544,356
Non-trainable params: 2,080
__________________________________________________________________________________________________
## ERR: number of trainable params 128544356 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 133496064
OPT eval latency = 0.02503993800000001
OPT eval accuracy_drop = 1
OPT eval energy = 3.1793206923744
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7e8f97a20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7489531770129924

Train accuracy: 0.7489531770129924



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.25104682298700765
OPT eval energy = 0.05136966204480002
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,122,833
Trainable params: 4,121,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7ee2a4ba0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5789529506398022

Train accuracy: 0.5789529506398022



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4137024
OPT eval latency = 0.0007764779999999998
OPT eval accuracy_drop = 0.42104704936019777
OPT eval energy = 0.10063039525439998

Evaluation of current population completed

gen  35
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,294,033
Trainable params: 2,293,937
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7f28cc4c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7576994286069556

Train accuracy: 0.7576994286069556



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2089344
OPT eval latency = 0.00043649399999999994
OPT eval accuracy_drop = 0.2423005713930444
OPT eval energy = 0.055683797136000024
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32253504
OPT eval latency = 0.006048318000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7698841570463999
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 7fc7a0560ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8573651370753328

Train accuracy: 0.8573651370753328



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085888
OPT eval latency = 0.0002044140000000001
OPT eval accuracy_drop = 0.1426348629246672
OPT eval energy = 0.0259947717792
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 800c96ca0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9232426315502416

Train accuracy: 0.9232426315502416



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085888
OPT eval latency = 0.0002044140000000001
OPT eval accuracy_drop = 0.07675736844975845
OPT eval energy = 0.0259947717792
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,292,241
Trainable params: 2,292,145
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 805e23320ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9273108375615016

Train accuracy: 0.9273108375615016



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2087552
OPT eval latency = 0.0004361579999999999
OPT eval accuracy_drop = 0.07268916243849843
OPT eval energy = 0.05539847615040002
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,313,361
Trainable params: 8,313,265
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 80ad67440ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7888006242988375

Train accuracy: 0.7888006242988375



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8343872
OPT eval latency = 0.0017432820000000005
OPT eval accuracy_drop = 0.21119937570116254
OPT eval energy = 0.22140129927360006
### EVAL candidate 6/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,292,241
Trainable params: 2,292,145
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 80f251ba0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5331340011843103

Train accuracy: 0.5331340011843103



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2087552
OPT eval latency = 0.0004361579999999999
OPT eval accuracy_drop = 0.4668659988156897
OPT eval energy = 0.05539847615040002
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 2,294,033
Trainable params: 2,293,937
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 814450280ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5529899574113628

Train accuracy: 0.5529899574113628



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2089344
OPT eval latency = 0.00043649399999999994
OPT eval accuracy_drop = 0.4470100425886372
OPT eval energy = 0.055683797136000024
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       256901120   reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 257,443,409
Trainable params: 257,442,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 257442353 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 257260800
OPT eval latency = 0.048239345999999995
OPT eval accuracy_drop = 1
OPT eval energy = 6.1239270874848

Evaluation of current population completed

gen  36
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 16, 8], [1, 28, 16, 8, 28, 2, 14, 10, 32], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '800c96ca0ec811ee974b218c4823db5d', 'accuracy_drop': 0.07675736844975845, 'energy': 0.0259947717792, 'latency': 0.0002044140000000001, 'memory': 1085888}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8225ff6e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7856742963904171

Train accuracy: 0.7856742963904171



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.21432570360958292
OPT eval energy = 0.3874534360224
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,399,441
Trainable params: 64,398,385
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64398385 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64562432
OPT eval latency = 0.012107826
OPT eval accuracy_drop = 1
OPT eval energy = 1.5372526204128005
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,407,889
Trainable params: 32,407,601
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32407601 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32752896
OPT eval latency = 0.006261138000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7958945659104003
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,407,889
Trainable params: 32,407,601
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32407601 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32752896
OPT eval latency = 0.006261138000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7958945659104003
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,114,129
Trainable params: 2,113,841
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 83d6c56e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9485421836943262

Train accuracy: 0.9485421836943262



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2097216
OPT eval latency = 0.00039401400000000015
OPT eval accuracy_drop = 0.05145781630567381
OPT eval energy = 0.050641215504000026
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,114,129
Trainable params: 2,113,841
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 842829ea0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.559368332160848

Train accuracy: 0.559368332160848



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2097216
OPT eval latency = 0.00039401400000000015
OPT eval accuracy_drop = 0.440631667839152
OPT eval energy = 0.050641215504000026
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 84775eac0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7940021955447707

Train accuracy: 0.7940021955447707



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085888
OPT eval latency = 0.0002044140000000001
OPT eval accuracy_drop = 0.2059978044552293
OPT eval energy = 0.0259947717792
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 84bc55fc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9295625757847599

Train accuracy: 0.9295625757847599



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085888
OPT eval latency = 0.0002044140000000001
OPT eval accuracy_drop = 0.07043742421524013
OPT eval energy = 0.0259947717792

Evaluation of current population completed

gen  37
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 4], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,072,081
Trainable params: 1,071,793
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 850ea5dc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5371396599354821

Train accuracy: 0.5371396599354821



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085888
OPT eval latency = 0.0002044140000000001
OPT eval accuracy_drop = 0.46286034006451793
OPT eval energy = 0.0259947717792
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,033
Trainable params: 1,069,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8553ba000ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9400938081031294

Train accuracy: 0.9400938081031294



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083840
OPT eval latency = 0.00020417400000000008
OPT eval accuracy_drop = 0.05990619189687063
OPT eval energy = 0.0259196442912
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,135,249
Trainable params: 8,134,961
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 85a548020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5063428470145698

Train accuracy: 0.5063428470145698



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8353536
OPT eval latency = 0.0015686579999999997
OPT eval accuracy_drop = 0.4936571529854302
OPT eval energy = 0.20018986088639995
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,033
Trainable params: 8,125,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 85f45b2c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8564124465246072

Train accuracy: 0.8564124465246072



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344320
OPT eval latency = 0.0015670739999999997
OPT eval accuracy_drop = 0.14358755347539276
OPT eval energy = 0.19893816381119994
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,293,457
Trainable params: 32,292,913
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32292913 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32452352
OPT eval latency = 0.006087186
OPT eval accuracy_drop = 1
OPT eval energy = 0.7742901795551999
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,168,273
Trainable params: 8,167,217
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 86d351920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5040062992399814

Train accuracy: 0.5040062992399814



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8153664
OPT eval latency = 0.001529598
OPT eval accuracy_drop = 0.4959937007600186
OPT eval energy = 0.1962380755104
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,168,273
Trainable params: 8,167,217
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 871871c80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6310741672397937

Train accuracy: 0.6310741672397937



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8153664
OPT eval latency = 0.001529598
OPT eval accuracy_drop = 0.3689258327602063
OPT eval energy = 0.1962380755104
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,033
Trainable params: 1,069,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 876b59880ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7371409705931505

Train accuracy: 0.7371409705931505



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083840
OPT eval latency = 0.00020417400000000008
OPT eval accuracy_drop = 0.26285902940684946
OPT eval energy = 0.0259196442912
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 87b02a900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9286479185951733

Train accuracy: 0.9286479185951733



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.07135208140482674
OPT eval energy = 0.04981851758400002

Evaluation of current population completed

gen  38
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 32], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 16,165,073
Trainable params: 16,164,017
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8801e5100ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9217242522147062

Train accuracy: 0.9217242522147062



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16414464
OPT eval latency = 0.0030800820000000013
OPT eval accuracy_drop = 0.07827574778529378
OPT eval energy = 0.3934991578848001
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,122,833
Trainable params: 4,121,777
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 88513a160ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6606844815685207

Train accuracy: 0.6606844815685207



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4137024
OPT eval latency = 0.0007764779999999998
OPT eval accuracy_drop = 0.33931551843147933
OPT eval energy = 0.10063039525439998
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,033
Trainable params: 8,125,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 88963e4a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5392668469415348

Train accuracy: 0.5392668469415348



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344320
OPT eval latency = 0.0015670739999999997
OPT eval accuracy_drop = 0.4607331530584652
OPT eval energy = 0.19893816381119994
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 88e81dbe0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5404987078731502

Train accuracy: 0.5404987078731502



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.45950129212684976
OPT eval energy = 0.04981851758400002
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 893763b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6850945923546544

Train accuracy: 0.6850945923546544



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.3149054076453456
OPT eval energy = 0.04981851758400002
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 897c905c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8373828337990903

Train accuracy: 0.8373828337990903



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.1626171662009097
OPT eval energy = 0.04981851758400002
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,440,913
Trainable params: 32,439,857
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32439857 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32253504
OPT eval latency = 0.006048318000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7698841570463999
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,804,433
Trainable params: 64,803,377
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64803377 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64386624
OPT eval latency = 0.012073278000000003
OPT eval accuracy_drop = 1
OPT eval energy = 1.5347455990944008
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8a5df5600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6181685543438793

Train accuracy: 0.6181685543438793



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.3818314456561207
OPT eval energy = 0.4124193282527999
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8aad1de80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7061188847555825

Train accuracy: 0.7061188847555825



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.2938811152444175
OPT eval energy = 0.4124193282527999

Evaluation of current population completed

gen  39
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 4], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,168,273
Trainable params: 8,167,217
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8af253220ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7322885715752028

Train accuracy: 0.7322885715752028



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8153664
OPT eval latency = 0.001529598
OPT eval accuracy_drop = 0.2677114284247972
OPT eval energy = 0.1962380755104
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8b44191e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.750562055428301

Train accuracy: 0.750562055428301



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.249437944571699
OPT eval energy = 0.3874534360224
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8b933a580ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.611120681015893

Train accuracy: 0.611120681015893



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.388879318984107
OPT eval energy = 0.3874534360224
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,230,481
Trainable params: 16,229,425
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8bd835040ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8256305514194435

Train accuracy: 0.8256305514194435



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16158272
OPT eval latency = 0.003030462000000001
OPT eval accuracy_drop = 0.17436944858055647
OPT eval energy = 0.3848271535776
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,167,761
Trainable params: 2,167,601
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8c2a9eca0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.54918326016052

Train accuracy: 0.54918326016052



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088384
OPT eval latency = 0.000407022
OPT eval accuracy_drop = 0.45081673983948
OPT eval energy = 0.05170500202560001
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,345
Trainable params: 2,171,185
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8c6f7c2a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7249463170733319

Train accuracy: 0.7249463170733319



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2091968
OPT eval latency = 0.00040769399999999995
OPT eval accuracy_drop = 0.2750536829266681
OPT eval energy = 0.05214440616000001
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8cc0b2a20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5960613223096451

Train accuracy: 0.5960613223096451



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.40393867769035485
OPT eval energy = 0.4124193282527999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,068,689
Trainable params: 1,068,593
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8d0fd6020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5351393997968819

Train accuracy: 0.5351393997968819



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317600
OPT eval latency = 0.000425874
OPT eval accuracy_drop = 0.46486060020311815
OPT eval energy = 0.0540641932512
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 2,093,777
Trainable params: 2,093,233
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8d54e7100ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9239973922519849

Train accuracy: 0.9239973922519849



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2107712
OPT eval latency = 0.0003959820000000001
OPT eval accuracy_drop = 0.07600260774801515
OPT eval energy = 0.05136966204480002
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,208,977
Trainable params: 8,208,433
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8da6c4d60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6328945866003293

Train accuracy: 0.6328945866003293



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8132672
OPT eval latency = 0.0015256620000000001
OPT eval accuracy_drop = 0.36710541339967073
OPT eval energy = 0.19478118242880002

Evaluation of current population completed

gen  40
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8df665a40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8624063427160943

Train accuracy: 0.8624063427160943



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.1375936572839057
OPT eval energy = 0.3874534360224
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8e3b5fa60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9201172711927635

Train accuracy: 0.9201172711927635



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.07988272880723646
OPT eval energy = 0.3874534360224
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,190,545
Trainable params: 8,190,001
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8e8e4cb60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5060197916926426

Train accuracy: 0.5060197916926426



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8114240
OPT eval latency = 0.001522494
OPT eval accuracy_drop = 0.49398020830735745
OPT eval energy = 0.1932787863072
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8ed3ea780ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7672744571170487

Train accuracy: 0.7672744571170487



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16150080
OPT eval latency = 0.003029502000000001
OPT eval accuracy_drop = 0.23272554288295133
OPT eval energy = 0.3845916434976
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,345
Trainable params: 2,171,185
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8f2394380ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8896060898941163

Train accuracy: 0.8896060898941163



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2091968
OPT eval latency = 0.00040769399999999995
OPT eval accuracy_drop = 0.11039391010588373
OPT eval energy = 0.05214440616000001
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,345
Trainable params: 2,171,185
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8f7605f60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5465538249587493

Train accuracy: 0.5465538249587493



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2091968
OPT eval latency = 0.00040769399999999995
OPT eval accuracy_drop = 0.45344617504125073
OPT eval energy = 0.05214440616000001
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 8fbb27940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6225204205883095

Train accuracy: 0.6225204205883095



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.3774795794116905
OPT eval energy = 0.04981851758400002
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,114,129
Trainable params: 2,113,841
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 900cae980ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7209984234652232

Train accuracy: 0.7209984234652232



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2097216
OPT eval latency = 0.00039401400000000015
OPT eval accuracy_drop = 0.27900157653477675
OPT eval energy = 0.050641215504000026
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 2, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 909d63ca0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8655466047254012

Train accuracy: 0.8655466047254012



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.13445339527459876
OPT eval energy = 0.3874534360224

Evaluation of current population completed

gen  41
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 90ef67920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7858126646698895

Train accuracy: 0.7858126646698895



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16150080
OPT eval latency = 0.003029502000000001
OPT eval accuracy_drop = 0.21418733533011047
OPT eval energy = 0.3845916434976
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 913474cc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8871807036448027

Train accuracy: 0.8871807036448027



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.11281929635519727
OPT eval energy = 0.3874534360224
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,132,177
Trainable params: 4,131,633
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 918547e40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9236300467419476

Train accuracy: 0.9236300467419476



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4116032
OPT eval latency = 0.0007725419999999999
OPT eval accuracy_drop = 0.0763699532580524
OPT eval energy = 0.09917350217279998
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,132,177
Trainable params: 4,131,633
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 91d7e1a20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7939285597089052

Train accuracy: 0.7939285597089052



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4116032
OPT eval latency = 0.0007725419999999999
OPT eval accuracy_drop = 0.2060714402910948
OPT eval energy = 0.09917350217279998
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,135,249
Trainable params: 8,134,961
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 921d14020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5710960096928593

Train accuracy: 0.5710960096928593



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8353536
OPT eval latency = 0.0015686579999999997
OPT eval accuracy_drop = 0.42890399030714066
OPT eval energy = 0.20018986088639995
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,033
Trainable params: 8,125,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 926e9d400ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7172260317879782

Train accuracy: 0.7172260317879782



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344320
OPT eval latency = 0.0015670739999999997
OPT eval accuracy_drop = 0.28277396821202183
OPT eval energy = 0.19893816381119994
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,215,889
Trainable params: 32,214,833
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32214833 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32436480
OPT eval latency = 0.006084785999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7724562809567999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,131,409
Trainable params: 8,130,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 92ff664a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6109914913942396

Train accuracy: 0.6109914913942396



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8116800
OPT eval latency = 0.001523262
OPT eval accuracy_drop = 0.3890085086057604
OPT eval energy = 0.1933762829856
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,033
Trainable params: 8,125,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 935141e00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.911656351503681

Train accuracy: 0.911656351503681



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344320
OPT eval latency = 0.0015670739999999997
OPT eval accuracy_drop = 0.08834364849631904
OPT eval energy = 0.19893816381119994
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 93960d520ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.749882332653018

Train accuracy: 0.749882332653018



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.25011766734698204
OPT eval energy = 0.04981851758400002

Evaluation of current population completed

gen  42
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 4], [-1], [1]], 'runid': '8553ba000ec811ee974b218c4823db5d', 'accuracy_drop': 0.05990619189687063, 'energy': 0.0259196442912, 'latency': 0.00020417400000000008, 'memory': 1083840}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]], 'runid': '8553ba000ec811ee974b218c4823db5d', 'accuracy_drop': 0.05990619189687063, 'energy': 0.0259196442912, 'latency': 0.00020417400000000008, 'memory': 1083840}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,068,689
Trainable params: 1,068,593
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 93e5c2de0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5970527090769568

Train accuracy: 0.5970527090769568



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317600
OPT eval latency = 0.000425874
OPT eval accuracy_drop = 0.40294729092304316
OPT eval energy = 0.0540641932512
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,068,689
Trainable params: 1,068,593
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9438216e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5262448428381561

Train accuracy: 0.5262448428381561



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317600
OPT eval latency = 0.000425874
OPT eval accuracy_drop = 0.4737551571618439
OPT eval energy = 0.0540641932512
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,033
Trainable params: 1,069,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 947d3d760ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6202278076808436

Train accuracy: 0.6202278076808436



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083840
OPT eval latency = 0.00020417400000000008
OPT eval accuracy_drop = 0.3797721923191564
OPT eval energy = 0.0259196442912
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,033
Trainable params: 1,069,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 94ceca920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6692965450072783

Train accuracy: 0.6692965450072783



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083840
OPT eval latency = 0.00020417400000000008
OPT eval accuracy_drop = 0.3307034549927217
OPT eval energy = 0.0259196442912
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 600,593
Trainable params: 600,497
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 951e19f80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6045795106310636

Train accuracy: 0.6045795106310636



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 583104
OPT eval latency = 0.00015411
OPT eval accuracy_drop = 0.39542048936893637
OPT eval energy = 0.0198354871968
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 600,593
Trainable params: 600,497
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 956311f20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.735827162210417

Train accuracy: 0.735827162210417



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 583104
OPT eval latency = 0.00015411
OPT eval accuracy_drop = 0.264172837789583
OPT eval energy = 0.0198354871968
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        250880      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 316,049
Trainable params: 315,953
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 95b535900ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5298204087481753

Train accuracy: 0.5298204087481753



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 329760
OPT eval latency = 0.00010659000000000002
OPT eval accuracy_drop = 0.47017959125182474
OPT eval energy = 0.013531472591999999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 960488840ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7410326289817445

Train accuracy: 0.7410326289817445



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.2589673710182555
OPT eval energy = 0.10316138775360001
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,345
Trainable params: 2,171,185
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 964a2b3c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.697897403703807

Train accuracy: 0.697897403703807



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2091968
OPT eval latency = 0.00040769399999999995
OPT eval accuracy_drop = 0.30210259629619296
OPT eval energy = 0.05214440616000001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,568,785
Trainable params: 8,568,625
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 969d09420ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6172914088041966

Train accuracy: 0.6172914088041966



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8116928
OPT eval latency = 0.0015373740000000006
OPT eval accuracy_drop = 0.38270859119580336
OPT eval energy = 0.195555926544

Evaluation of current population completed

gen  43
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '7c375f620ec811ee974b218c4823db5d', 'accuracy_drop': 0.053870945219542055, 'energy': 0.384520525968, 'latency': 0.003028590000000001, 'memory': 16148288}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,568,785
Trainable params: 8,568,625
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 96e2cb940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6426907183712497

Train accuracy: 0.6426907183712497



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8116928
OPT eval latency = 0.0015373740000000006
OPT eval accuracy_drop = 0.3573092816287503
OPT eval energy = 0.195555926544
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 1,105,105
Trainable params: 1,104,945
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9734f36a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9405027729689198

Train accuracy: 0.9405027729689198



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1087808
OPT eval latency = 0.00021943800000000008
OPT eval accuracy_drop = 0.05949722703108018
OPT eval energy = 0.028245532867200007
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 2,171,345
Trainable params: 2,171,185
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 978436a00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9012585376638493

Train accuracy: 0.9012585376638493



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2091968
OPT eval latency = 0.00040769399999999995
OPT eval accuracy_drop = 0.09874146233615066
OPT eval energy = 0.05214440616000001
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,208,977
Trainable params: 8,208,433
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 97c94e660ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5400532326919156

Train accuracy: 0.5400532326919156



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8132672
OPT eval latency = 0.0015256620000000001
OPT eval accuracy_drop = 0.45994676730808437
OPT eval energy = 0.19478118242880002
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,126,033
Trainable params: 8,125,745
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 981b4b4e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8285143307490852

Train accuracy: 0.8285143307490852



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344320
OPT eval latency = 0.0015670739999999997
OPT eval accuracy_drop = 0.1714856692509148
OPT eval energy = 0.19893816381119994
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,216,913
Trainable params: 16,216,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 986a83800ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8789690282267739

Train accuracy: 0.8789690282267739



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373760
OPT eval latency = 0.0030725940000000014
OPT eval accuracy_drop = 0.12103097177322608
OPT eval energy = 0.3900621211872001
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,070,993
Trainable params: 1,070,897
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 98af9eca0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5844909674178638

Train accuracy: 0.5844909674178638



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.41550903258213623
OPT eval energy = 0.0548194419168
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 1,068,689
Trainable params: 1,068,593
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9901f6200ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5229391304174583

Train accuracy: 0.5229391304174583



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1317600
OPT eval latency = 0.000425874
OPT eval accuracy_drop = 0.4770608695825417
OPT eval energy = 0.0540641932512
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 32,215,889
Trainable params: 32,214,833
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 32214833 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32436480
OPT eval latency = 0.006084785999999999
OPT eval accuracy_drop = 1
OPT eval energy = 0.7724562809567999
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 8,131,409
Trainable params: 8,130,353
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9994d5940ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8783775410114665

Train accuracy: 0.8783775410114665



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8116800
OPT eval latency = 0.001523262
OPT eval accuracy_drop = 0.12162245898853352
OPT eval energy = 0.1933762829856

Evaluation of current population completed

gen  44
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '4d90fb500ec811ee974b218c4823db5d', 'accuracy_drop': 0.09572772391493578, 'energy': 0.0138577221024, 'latency': 0.00010702200000000002, 'memory': 332064}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '9734f36a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05949722703108018, 'energy': 0.028245532867200007, 'latency': 0.00021943800000000008, 'memory': 1087808}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 4], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,113,745
Trainable params: 4,113,201
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 99e434d60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7776271707136239

Train accuracy: 0.7776271707136239



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4097600
OPT eval latency = 0.0007693739999999999
OPT eval accuracy_drop = 0.22237282928637614
OPT eval energy = 0.09767110605119998
### EVAL candidate 1/10
[[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 256]
Added Conv1_layer
[None, 14, 14, 256]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 256)  2560        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,113,745
Trainable params: 4,113,201
Non-trainable params: 544
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9a2934140ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8928178177258188

Train accuracy: 0.8928178177258188



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4097600
OPT eval latency = 0.0007693739999999999
OPT eval accuracy_drop = 0.10718218227418119
OPT eval energy = 0.09767110605119998
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 1, 28, 8, 32], [1, 28, 8, 32, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 256]
Added Conv1_layer
[None, 28, 28, 256]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 256)  20992       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 256)  1024        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 25088, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 32,293,457
Trainable params: 32,292,913
Non-trainable params: 544
__________________________________________________________________________________________________
## ERR: number of trainable params 32292913 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32452352
OPT eval latency = 0.006087186
OPT eval accuracy_drop = 1
OPT eval energy = 0.7742901795551999
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64591104
OPT eval latency = 0.012113202
OPT eval accuracy_drop = 1
OPT eval energy = 1.5402429021408004
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,115,665
Trainable params: 4,115,505
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9b098a460ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8736601147623169

Train accuracy: 0.8736601147623169



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4333568
OPT eval latency = 0.0008737620000000001
OPT eval accuracy_drop = 0.12633988523768314
OPT eval energy = 0.11174017863360004
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 1,105,105
Trainable params: 1,104,945
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9b5c1df60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9324649713806704

Train accuracy: 0.9324649713806704



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1087808
OPT eval latency = 0.00021943800000000008
OPT eval accuracy_drop = 0.06753502861932958
OPT eval energy = 0.028245532867200007
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9ba177340ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8070752511604223

Train accuracy: 0.8070752511604223



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.19292474883957766
OPT eval energy = 0.4124193282527999
### EVAL candidate 7/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9bf318c80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7008192655409293

Train accuracy: 0.7008192655409293



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.2991807344590707
OPT eval energy = 0.4124193282527999
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 600,593
Trainable params: 600,497
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9c4272100ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6478461998408442

Train accuracy: 0.6478461998408442



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 583104
OPT eval latency = 0.00015411
OPT eval accuracy_drop = 0.35215380015915576
OPT eval energy = 0.0198354871968
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,165,073
Trainable params: 1,164,977
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9c8775680ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6869439630495683

Train accuracy: 0.6869439630495683



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085184
OPT eval latency = 0.000248238
OPT eval accuracy_drop = 0.3130560369504317
OPT eval energy = 0.0317849238432

Evaluation of current population completed

gen  45
{'gene': [[0, 28, 1, 1, 9, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '9734f36a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05949722703108018, 'energy': 0.028245532867200007, 'latency': 0.00021943800000000008, 'memory': 1087808}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '06bc0d0a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05920663570220719, 'energy': 20.96720067614401, 'latency': 0.0012355860000000003, 'memory': 5941072}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 5, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,400,721
Trainable params: 32,400,433
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32400433 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32745728
OPT eval latency = 0.006259794000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7947829961952003
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 32,400,721
Trainable params: 32,400,433
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 32400433 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32745728
OPT eval latency = 0.006259794000000001
OPT eval accuracy_drop = 1
OPT eval energy = 0.7947829961952003
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 1, 28, 16, 8], [1, 28, 16, 8, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,218,961
Trainable params: 16,218,673
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9d68c7d40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6180747462635791

Train accuracy: 0.6180747462635791



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16688128
OPT eval latency = 0.0032489940000000007
OPT eval accuracy_drop = 0.38192525373642094
OPT eval energy = 0.41256554915519994
### EVAL candidate 3/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9db7d1e40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5724165884228996

Train accuracy: 0.5724165884228996



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.42758341157710045
OPT eval energy = 0.10324260878400002
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 1,100,497
Trainable params: 1,100,337
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9dfce8920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.912123722200924

Train accuracy: 0.912123722200924



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083200
OPT eval latency = 0.00021862200000000008
OPT eval accuracy_drop = 0.08787627779907603
OPT eval energy = 0.027753800553600008
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 8,564,177
Trainable params: 8,564,017
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9e4ec6260ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.930243126212785

Train accuracy: 0.930243126212785



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8112320
OPT eval latency = 0.0015365580000000006
OPT eval accuracy_drop = 0.06975687378721496
OPT eval energy = 0.1950641942304
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  10496       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,183,889
Trainable params: 4,183,601
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9e9e14f60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.700526774558334

Train accuracy: 0.700526774558334



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4182656
OPT eval latency = 0.0008142540000000003
OPT eval accuracy_drop = 0.299473225441666
OPT eval energy = 0.10399017921600003
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 2, 14, 16, 8], [1, 14, 16, 8, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 16]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  3328        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 16)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,176,721
Trainable params: 4,176,433
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9ee339000ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6081121245332533

Train accuracy: 0.6081121245332533



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4175488
OPT eval latency = 0.0008129100000000002
OPT eval accuracy_drop = 0.39188787546674675
OPT eval energy = 0.10324260878400002
### EVAL candidate 8/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,165,073
Trainable params: 1,164,977
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9f3568740ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8906461095932207

Train accuracy: 0.8906461095932207



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085184
OPT eval latency = 0.000248238
OPT eval accuracy_drop = 0.10935389040677934
OPT eval energy = 0.0317849238432
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,165,073
Trainable params: 1,164,977
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9f7a62f80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8725620693175736

Train accuracy: 0.8725620693175736



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1085184
OPT eval latency = 0.000248238
OPT eval accuracy_drop = 0.12743793068242637
OPT eval energy = 0.0317849238432

Evaluation of current population completed

gen  46
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '9dfce8920ec811ee974b218c4823db5d', 'accuracy_drop': 0.08787627779907603, 'energy': 0.027753800553600008, 'latency': 0.00021862200000000008, 'memory': 1083200}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '8553ba000ec811ee974b218c4823db5d', 'accuracy_drop': 0.05990619189687063, 'energy': 0.0259196442912, 'latency': 0.00020417400000000008, 'memory': 1083840}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]], 'runid': '9dfce8920ec811ee974b218c4823db5d', 'accuracy_drop': 0.08787627779907603, 'energy': 0.027753800553600008, 'latency': 0.00021862200000000008, 'memory': 1083200}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,111,057
Trainable params: 4,110,897
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: 9fca1e600ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8261656135119806

Train accuracy: 0.8261656135119806



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4328960
OPT eval latency = 0.0008729460000000002
OPT eval accuracy_drop = 0.1738343864880194
OPT eval energy = 0.11081944716480004
### EVAL candidate 1/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,112,081
Trainable params: 4,111,921
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a01c84b60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6857847346891223

Train accuracy: 0.6857847346891223



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4329984
OPT eval latency = 0.0008730900000000002
OPT eval accuracy_drop = 0.31421526531087773
OPT eval energy = 0.11093677521600004
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a0619a740ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7901772973089611

Train accuracy: 0.7901772973089611



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.20982270269103886
OPT eval energy = 0.10316138775360001
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a0b36a3e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6524497524851024

Train accuracy: 0.6524497524851024



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.3475502475148976
OPT eval energy = 0.10316138775360001
### EVAL candidate 4/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 2, 7, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,281
Trainable params: 1,163,185
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a10296c20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8718390077913226

Train accuracy: 0.8718390077913226



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083392
OPT eval latency = 0.00024790200000000004
OPT eval accuracy_drop = 0.12816099220867738
OPT eval energy = 0.0314996028576
### EVAL candidate 5/10
[[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       1003520     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 1,163,281
Trainable params: 1,163,185
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a147a8b60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6201517361759353

Train accuracy: 0.6201517361759353



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083392
OPT eval latency = 0.00024790200000000004
OPT eval accuracy_drop = 0.37984826382406467
OPT eval energy = 0.0314996028576
### EVAL candidate 6/10
[[0, 28, 1, 1, 3, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,591,889
Trainable params: 16,591,793
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a199c0e20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6166942448757805

Train accuracy: 0.6166942448757805



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16372800
OPT eval latency = 0.003248706000000001
OPT eval accuracy_drop = 0.3833057551242195
OPT eval energy = 0.4124193282527999
### EVAL candidate 7/10
[[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   832         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,592,401
Trainable params: 16,592,305
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a1e937260ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6880310810304894

Train accuracy: 0.6880310810304894



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373312
OPT eval latency = 0.003248802000000001
OPT eval accuracy_drop = 0.3119689189695106
OPT eval energy = 0.41252525664959994
### EVAL candidate 8/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 4,112,081
Trainable params: 4,111,921
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a22e44b00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5333077458444706

Train accuracy: 0.5333077458444706



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4329984
OPT eval latency = 0.0008730900000000002
OPT eval accuracy_drop = 0.4666922541555294
OPT eval energy = 0.11093677521600004
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,188,881
Trainable params: 8,188,721
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a280b5920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7991175244945947

Train accuracy: 0.7991175244945947



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8344704
OPT eval latency = 0.0016258259999999997
OPT eval accuracy_drop = 0.20088247550540528
OPT eval energy = 0.20649570713280002

Evaluation of current population completed

gen  47
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 16], [-1], [1]], 'runid': '2889bdb00ec811ee974b218c4823db5d', 'accuracy_drop': 0.1666712053973216, 'energy': 0.0074863277088, 'latency': 5.520600000000001e-05, 'memory': 136828}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '9734f36a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05949722703108018, 'energy': 0.028245532867200007, 'latency': 0.00021943800000000008, 'memory': 1087808}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 5, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]], 'runid': '2c1ad27a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.18295415397006476, 'energy': 0.006667365993600001, 'latency': 4.349400000000001e-05, 'memory': 74300}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]], 'runid': '9734f36a0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05949722703108018, 'energy': 0.028245532867200007, 'latency': 0.00021943800000000008, 'memory': 1087808}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,175,633
Trainable params: 4,175,537
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a2c662c20ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.9350813835308518

Train accuracy: 0.9350813835308518



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4330944
OPT eval latency = 0.000990882
OPT eval accuracy_drop = 0.0649186164691482
OPT eval energy = 0.1264916876256
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 4,175,633
Trainable params: 4,175,537
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a31854a60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7365211844488335

Train accuracy: 0.7365211844488335



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4330944
OPT eval latency = 0.000990882
OPT eval accuracy_drop = 0.2634788155511665
OPT eval energy = 0.1264916876256
### EVAL candidate 2/10
[[0, 28, 1, 1, 5, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  13312       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,230,481
Trainable params: 16,229,425
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a36787880ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6796758069393766

Train accuracy: 0.6796758069393766



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16158272
OPT eval latency = 0.003030462000000001
OPT eval accuracy_drop = 0.32032419306062343
OPT eval energy = 0.3848271535776
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a3ac8af40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5827917737063643

Train accuracy: 0.5827917737063643



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16150080
OPT eval latency = 0.003029502000000001
OPT eval accuracy_drop = 0.41720822629363574
OPT eval energy = 0.3845916434976
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   640         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       32112640    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 32,648,657
Trainable params: 32,648,497
Non-trainable params: 160
__________________________________________________________________________________________________
## ERR: number of trainable params 32648497 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 32432000
OPT eval latency = 0.006142242000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.7797502512095998
### EVAL candidate 5/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,762,193
Trainable params: 64,761,905
Non-trainable params: 288
__________________________________________________________________________________________________
## ERR: number of trainable params 64761905 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64550400
OPT eval latency = 0.012105714
OPT eval accuracy_drop = 1
OPT eval energy = 1.5368058654432004
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 16,594,193
Trainable params: 16,594,097
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a48dce2e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8225171059295203

Train accuracy: 0.8225171059295203



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16375104
OPT eval latency = 0.003249138000000001
OPT eval accuracy_drop = 0.17748289407047968
OPT eval energy = 0.4131745769183999
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,105,873
Trainable params: 2,105,777
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a4e0052c0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7719224223220403

Train accuracy: 0.7719224223220403



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2323584
OPT eval latency = 0.000614514
OPT eval accuracy_drop = 0.22807757767795966
OPT eval energy = 0.0787122216672
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,216,913
Trainable params: 16,216,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a52505280ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8237780660985595

Train accuracy: 0.8237780660985595



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16373760
OPT eval latency = 0.0030725940000000014
OPT eval accuracy_drop = 0.17622193390144048
OPT eval energy = 0.3900621211872001
### EVAL candidate 9/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,080,593
Trainable params: 4,080,305
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a576b7f60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8959905185563809

Train accuracy: 0.8959905185563809



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4329600
OPT eval latency = 0.0008143380000000003
OPT eval accuracy_drop = 0.1040094814436191
OPT eval energy = 0.10337923189440003

Evaluation of current population completed

gen  48
{'gene': [[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 16], [-1], [1]], 'runid': '2e08d5320ec811ee974b218c4823db5d', 'accuracy_drop': 0.07288738888772239, 'energy': 0.0540365562528, 'latency': 0.000424254, 'memory': 1083216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 32], [1, 14, 8, 32, 14, 2, 7, 10, 8], [-1], [1]], 'runid': '83d6c56e0ec811ee974b218c4823db5d', 'accuracy_drop': 0.05145781630567381, 'energy': 0.050641215504000026, 'latency': 0.00039401400000000015, 'memory': 2097216}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 8], [-1], [1]], 'runid': '43412b660ec811ee974b218c4823db5d', 'accuracy_drop': 0.05932057698736504, 'energy': 0.0548194419168, 'latency': 0.000426306, 'memory': 1319904}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 2, 7, 10, 64], [-1], [1]], 'runid': '3b4343540ec811ee974b218c4823db5d', 'accuracy_drop': 0.08205581967254527, 'energy': 0.036109354512, 'latency': 0.000283038, 'memory': 330096}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
{'gene': [[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]], 'runid': '8553ba000ec811ee974b218c4823db5d', 'accuracy_drop': 0.05990619189687063, 'energy': 0.0259196442912, 'latency': 0.00020417400000000008, 'memory': 1083840}
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
mute_type = 0
Fixing...
Fixed.
mute_type = 0
Fixing...
Fixed.
### EVAL candidate 0/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 1, 28, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,315,153
Trainable params: 8,315,057
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a5c6a1d00ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6363669258325999

Train accuracy: 0.6363669258325999



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8345664
OPT eval latency = 0.0017436180000000006
OPT eval accuracy_drop = 0.3636330741674001
OPT eval energy = 0.22205061954240005
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,315,153
Trainable params: 8,315,057
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a60bebe60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7846115074356843

Train accuracy: 0.7846115074356843



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 8345664
OPT eval latency = 0.0017436180000000006
OPT eval accuracy_drop = 0.2153884925643157
OPT eval energy = 0.22205061954240005
### EVAL candidate 2/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 2, 7, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a65dae5e0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8339857188620469

Train accuracy: 0.8339857188620469



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.16601428113795313
OPT eval energy = 0.04981851758400002
### EVAL candidate 3/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a6aceafa0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.6069819306186655

Train accuracy: 0.6069819306186655



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2088000
OPT eval latency = 0.00039243000000000014
OPT eval accuracy_drop = 0.39301806938133454
OPT eval energy = 0.04981851758400002
### EVAL candidate 4/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 571,985
Trainable params: 571,825
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a6f1f69a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7907787525896168

Train accuracy: 0.7907787525896168



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 585728
OPT eval latency = 0.00012531
OPT eval accuracy_drop = 0.20922124741038317
OPT eval energy = 0.016296096220800003
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 571,985
Trainable params: 571,825
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a7444cd80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5008401308706077

Train accuracy: 0.5008401308706077



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 585728
OPT eval latency = 0.00012531
OPT eval accuracy_drop = 0.49915986912939225
OPT eval energy = 0.016296096220800003
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 64,804,433
Trainable params: 64,803,377
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64803377 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 64386624
OPT eval latency = 0.012073278000000003
OPT eval accuracy_drop = 1
OPT eval energy = 1.5347455990944008
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a7d74f920ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.532112880682479

Train accuracy: 0.532112880682479



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 16186944
OPT eval latency = 0.003035838000000001
OPT eval accuracy_drop = 0.467887119317521
OPT eval energy = 0.3874534360224
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   320         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,549,649
Trainable params: 4,549,553
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a826a4d40ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7439087159877853

Train accuracy: 0.7439087159877853



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4095360
OPT eval latency = 0.0008126220000000003
OPT eval accuracy_drop = 0.2560912840122147
OPT eval energy = 0.10316138775360001
### EVAL candidate 9/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,551,953
Trainable params: 4,551,857
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a86bd1260ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8303058110105623

Train accuracy: 0.8303058110105623



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 4097664
OPT eval latency = 0.0008130540000000002
OPT eval accuracy_drop = 0.16969418898943767
OPT eval energy = 0.10348763726400001

Evaluation of current population completed

gen  49
### EVAL candidate 0/10
[[0, 28, 1, 1, 3, 2, 14, 8, 16], [1, 14, 8, 16, 14, 1, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 128]
Added Conv1_layer
[None, 14, 14, 128]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,104,913
Trainable params: 2,104,625
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a8bdee520ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8081029607354908

Train accuracy: 0.8081029607354908



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 2097216
OPT eval latency = 0.00039401400000000015
OPT eval accuracy_drop = 0.19189703926450918
OPT eval energy = 0.050641215504000026
### EVAL candidate 1/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 8], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 8]
[None, 10, 8]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               63504     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 96,081
Trainable params: 96,049
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 8)        2007040     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 80)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    96081       mask_1[0][0]                     
==================================================================================================
Total params: 2,105,873
Trainable params: 2,105,777
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a90d4be60ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8239159481857591

Train accuracy: 0.8239159481857591



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 74300
OPT eval latency = 4.349400000000001e-05
OPT eval accuracy_drop = 0.17608405181424092
OPT eval energy = 0.006667365993600001
### EVAL candidate 2/10
[[0, 28, 1, 1, 9, 2, 14, 8, 8], [1, 14, 8, 8, 14, 1, 14, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 64]
Added Conv1_layer
[None, 14, 14, 64]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 64)   5248        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1568, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        501760      reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 571,985
Trainable params: 571,825
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a95278240ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8281351971790587

Train accuracy: 0.8281351971790587



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1319904
OPT eval latency = 0.000426306
OPT eval accuracy_drop = 0.1718648028209413
OPT eval energy = 0.0548194419168
### EVAL candidate 3/10
[[0, 28, 1, 1, 9, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,259,153
Trainable params: 16,258,097
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a9a4de200ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7238112670312852

Train accuracy: 0.7238112670312852



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 330096
OPT eval latency = 0.000283038
OPT eval accuracy_drop = 0.2761887329687148
OPT eval energy = 0.036109354512
### EVAL candidate 4/10
[[0, 28, 1, 1, 3, 2, 14, 8, 64], [1, 14, 8, 64, 14, 1, 14, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 512]
Added Conv1_layer
[None, 14, 14, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 512)  5120        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       16056320    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 16,222,289
Trainable params: 16,221,233
Non-trainable params: 1,056
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: a9e9f3020ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.8661693181860635

Train accuracy: 0.8661693181860635



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 136828
OPT eval latency = 5.520600000000001e-05
OPT eval accuracy_drop = 0.13383068181393654
OPT eval energy = 0.0074863277088
### EVAL candidate 5/10
[[0, 28, 1, 1, 9, 1, 28, 8, 4], [1, 28, 8, 4, 28, 2, 14, 10, 32], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 32]
Added Conv1_layer
[None, 28, 28, 32]
[None, None, 8]
[None, 10, 32]
[None, 10, 32]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               251664    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 284,241
Trainable params: 284,209
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3136, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 32)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 320)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    284241      mask_1[0][0]                     
==================================================================================================
Total params: 8,315,153
Trainable params: 8,315,057
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: aa3b79520ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.5847981844548722

Train accuracy: 0.5847981844548722



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083216
OPT eval latency = 0.000424254
OPT eval accuracy_drop = 0.4152018155451278
OPT eval energy = 0.0540365562528
### EVAL candidate 6/10
[[0, 28, 1, 1, 9, 1, 28, 8, 64], [1, 28, 8, 64, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 512]
Added Conv1_layer
[None, 28, 28, 512]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 512)  41984       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 512)  2048        conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 50176, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       64225280    reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 64,428,113
Trainable params: 64,427,057
Non-trainable params: 1,056
__________________________________________________________________________________________________
## ERR: number of trainable params 64427057 exceeded limit 20000000

Train accuracy: 0



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 332064
OPT eval latency = 0.00010702200000000002
OPT eval accuracy_drop = 1
OPT eval energy = 0.0138577221024
### EVAL candidate 7/10
[[0, 28, 1, 1, 9, 2, 14, 8, 4], [1, 14, 8, 4, 14, 1, 14, 10, 64], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 14, 14, 32]
Added Conv1_layer
[None, 14, 14, 32]
[None, None, 8]
[None, 10, 64]
[None, 10, 64]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               502544    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 535,121
Trainable params: 535,089
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 14, 14, 32)   2624        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 14, 14, 32)   128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 784, 8)       0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 64)       4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 640)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    535121      mask_1[0][0]                     
==================================================================================================
Total params: 4,551,953
Trainable params: 4,551,857
Non-trainable params: 96
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: aacc59cc0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.758650475592223

Train accuracy: 0.758650475592223



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083840
OPT eval latency = 0.00020417400000000008
OPT eval accuracy_drop = 0.24134952440777702
OPT eval energy = 0.0259196442912
### EVAL candidate 8/10
[[0, 28, 1, 1, 3, 1, 28, 8, 16], [1, 28, 8, 16, 28, 1, 28, 10, 4], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 128]
Added Conv1_layer
[None, 28, 28, 128]
[None, None, 8]
[None, 10, 4]
[None, 10, 4]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               32144     
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 64,721
Trainable params: 64,689
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 128)  1280        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 128)  512         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 12544, 8)     0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 4)        4014080     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 40)           0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    64721       mask_1[0][0]                     
==================================================================================================
Total params: 4,080,593
Trainable params: 4,080,305
Non-trainable params: 288
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: ab1e385a0ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7685267783065685

Train accuracy: 0.7685267783065685



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1087808
OPT eval latency = 0.00021943800000000008
OPT eval accuracy_drop = 0.23147322169343154
OPT eval energy = 0.028245532867200007
### EVAL candidate 9/10
[[0, 28, 1, 1, 5, 1, 28, 8, 8], [1, 28, 8, 8, 28, 1, 28, 10, 16], [-1], [1]]

Wrapping...

Number of devices: 1
x_train shape: (28, 28, 1)
### Input shape
xtra_skip is -1

[None, 28, 28, 64]
Added Conv1_layer
[None, 28, 28, 64]
[None, None, 8]
[None, 10, 16]
[None, 10, 16]
Added ClassCaps_layer

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 784)               126224    
_________________________________________________________________
reshape_2 (Reshape)          (None, 7, 7, 16)          0         
_________________________________________________________________
batch_normalization_2 (Batch (None, 7, 7, 16)          64        
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 7, 7, 64)          9280      
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 14, 14, 32)        18464     
_________________________________________________________________
conv2d_transpose_3 (Conv2DTr (None, 28, 28, 16)        4624      
_________________________________________________________________
conv2d_transpose_4 (Conv2DTr (None, 28, 28, 1)         145       
_________________________________________________________________
activation_1 (Activation)    (None, 28, 28, 1)         0         
_________________________________________________________________
out_recon (Reshape)          (None, 28, 28, 1)         0         
=================================================================
Total params: 158,801
Trainable params: 158,769
Non-trainable params: 32
_________________________________________________________________
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 28, 28, 1)    0                                            
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 28, 28, 64)   1664        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 28, 28, 64)   256         conv2d_1[0][0]                   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 6272, 8)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
digitcaps (CapsuleLayer)        (None, 10, 16)       8028160     reshape_1[0][0]                  
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
mask_1 (Mask)                   (None, 160)          0           digitcaps[0][0]                  
                                                                 input_2[0][0]                    
__________________________________________________________________________________________________
capsnet (Length)                (None, 10)           0           digitcaps[0][0]                  
__________________________________________________________________________________________________
decoder (Sequential)            (None, 28, 28, 1)    158801      mask_1[0][0]                     
==================================================================================================
Total params: 8,188,881
Trainable params: 8,188,721
Non-trainable params: 160
__________________________________________________________________________________________________
Train shapes: (60000, 28, 28, 1) (60000, 10)
### runid: ab6da5e80ec811ee974b218c4823db5d
Single-GPU model is used
Assume it's training
Assume it's epoch 1/5
Assume it's epoch 2/5
Assume it's epoch 3/5
Assume it's epoch 4/5
Assume it's epoch 5/5
------------------------------Begin: test------------------------------
Assume the Test acc is: 0.7065166171613303

Train accuracy: 0.7065166171613303



HW Estimator

2
1
0

Parsed gene

OPT eval memory = 1083200
OPT eval latency = 0.00021862200000000008
OPT eval accuracy_drop = 0.2934833828386697
OPT eval energy = 0.027753800553600008

Evaluation of current population completed

Filt pareto combinations: 2 in 302.234781 seconds
